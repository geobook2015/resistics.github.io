

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Intersite transfer functions &mdash; resistics 0.0.6rc1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cookbook" href="../cookbook.html" />
    <link rel="prev" title="Remote reference with configuration" href="remote-reference-with-config.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../advanced.html">Advanced</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pre-process.html">Pre-processing timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference.html">Remote reference processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference-statistics.html">Remote reference statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference-with-config.html">Remote reference with configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Intersite transfer functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case-studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog / backlog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">resistics</a> &raquo;</li>
        
          <li><a href="../advanced.html">Advanced</a> &raquo;</li>
        
      <li>Intersite transfer functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/advanced/intersite-transfer-function.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="intersite-transfer-functions">
<h1>Intersite transfer functions<a class="headerlink" href="#intersite-transfer-functions" title="Permalink to this headline">¶</a></h1>
<p>Intesite transfer functions use input channels from one site and output channels from another. In magnetotellurics, the input sites are usually magnetic and the output electric. In field surveys intended for intersite transfer functions, there are often many sites that record electric channels only.</p>
<p>In the following example, the data used will be:</p>
<ul class="simple">
<li>Data from a Lemi B423 MT station. This data is used in the <a class="reference internal" href="../cookbook/processing-lemi-b423.html"><span class="doc">Processing Lemi B423 data</span></a> example.</li>
<li>Data from a Lemi B423 telluric station recording only electric channels.</li>
</ul>
<p>And from the perspective of the magnetotelluric transfer function:</p>
<ul class="simple">
<li>The telluric site is the output site as the electric channels are the output of the standard magnetotelluric impedance tensor formulation.</li>
<li>The magnetotelluric site is the input site as the magnetic channels are the input of the standard magnetotelluric impedance tensor formulation.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is recommend to read the <a class="reference internal" href="../cookbook/processing-lemi-b423.html"><span class="doc">Processing Lemi B423 data</span></a> example in the cookbook before following this tutorial to understand more about Lemi B423 data.</p>
</div>
<p>The steps that will be followed are:</p>
<ol class="arabic simple">
<li>Create the project and organise the data (magnetotelluric, telluric and calibration)</li>
<li>Create the Lemi B423 headers and B423E headers</li>
<li>Define the configuration to use (based on the results in <a class="reference internal" href="../cookbook/processing-lemi-b423.html"><span class="doc">Processing Lemi B423 data</span></a>)</li>
<li>Calculate spectra (and statistics for the MT site)</li>
<li>Process to estimate the intersite impedance tensor</li>
</ol>
<p>Begin by creating the project,</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">intersitePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">newProject</span>

<span class="n">refTime</span> <span class="o">=</span> <span class="s2">&quot;2019-05-27 00:00:00&quot;</span>
<span class="n">newProject</span><span class="p">(</span><span class="n">intersitePath</span><span class="p">,</span> <span class="n">refTime</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Copy the data in there to give this structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usingLemi
├── calData
│   ├── lemi120_IC_710.txt
│   ├── lemi120_IC_712.txt
│   └── lemi120_IC_714.txt
├── timeData
│   ├── site1_mt
│   │   └── lemi01
│   │       ├── 1558950203.B423
│   │       ├── 1558961007.B423
│   │       ├── 1558971807.B423
│   │       ├── 1558982607.B423
│   │       ├── 1558993407.B423
│   │       ├── 1559004207.B423
│   │       ├── 1559015007.B423
│   │       └── 1559025807.B423
│   └── site2_te
│       └── lemi01
│           ├── 1558948829.B423
│           ├── 1558959633.B423
│           ├── 1558970433.B423
│           ├── 1558981233.B423
│           ├── 1558992033.B423
│           ├── 1559002833.B423
│           ├── 1559013633.B423
│           ├── 1559024433.B423
│           ├── 1559035233.B423
│           ├── 1559046033.B423
│           ├── 1559056833.B423
│           ├── 1559067633.B423
│           ├── 1559078433.B423
│           └── 1559089233.B423
├── specData
├── statData
├── maskData
├── transFuncData
├── images
└── mtProj.prj
</pre></div>
</div>
<p>The next stage is to create the headers for both the magnetotelluric and telluric data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">intersitePath</span><span class="p">,</span> <span class="n">intersiteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># headers for MT stations</span>
<span class="kn">from</span> <span class="nn">resistics.time.reader_lemib423</span> <span class="kn">import</span> <span class="n">folderB423Headers</span>

<span class="n">folderB423Headers</span><span class="p">(</span>
    <span class="n">intersitePath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">hxSensor</span><span class="o">=</span><span class="mi">712</span><span class="p">,</span>
    <span class="n">hySensor</span><span class="o">=</span><span class="mi">710</span><span class="p">,</span>
    <span class="n">hzSensor</span><span class="o">=</span><span class="mi">714</span><span class="p">,</span>
    <span class="n">hGain</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">dx</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">dy</span><span class="o">=</span><span class="mf">60.7</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># headers for telluric only stations</span>
<span class="kn">from</span> <span class="nn">resistics.time.reader_lemib423e</span> <span class="kn">import</span> <span class="n">folderB423EHeaders</span>

<span class="n">folderB423EHeaders</span><span class="p">(</span>
    <span class="n">intersitePath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">ex</span><span class="o">=</span><span class="s2">&quot;E1&quot;</span><span class="p">,</span> <span class="n">ey</span><span class="o">=</span><span class="s2">&quot;E2&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">60.7</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>After running this section, the project now looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usingLemi
├── calData
│   ├── lemi120_IC_710.txt
│   ├── lemi120_IC_712.txt
│   └── lemi120_IC_714.txt
├── timeData
│   ├── site1_mt
│   │   └── lemi01
│   │       ├── 1558950203.B423
│   │       ├── 1558961007.B423
│   │       ├── 1558971807.B423
│   │       ├── 1558982607.B423
│   │       ├── 1558993407.B423
│   │       ├── 1559004207.B423
│   │       ├── 1559015007.B423
│   │       ├── 1559025807.B423
│   │       ├── chan_00.h423
│   │       ├── chan_01.h423
│   │       ├── chan_02.h423
│   │       ├── chan_03.h423
│   │       ├── chan_04.h423
│   │       └── global.h423
│   └── site2_te
│       └── lemi01
│           ├── 1558948829.B423
│           ├── 1558959633.B423
│           ├── 1558970433.B423
│           ├── 1558981233.B423
│           ├── 1558992033.B423
│           ├── 1559002833.B423
│           ├── 1559013633.B423
│           ├── 1559024433.B423
│           ├── 1559035233.B423
│           ├── 1559046033.B423
│           ├── 1559056833.B423
│           ├── 1559067633.B423
│           ├── 1559078433.B423
│           ├── 1559089233.B423
│           ├── chan_00.h423
│           ├── chan_01.h423
│           ├── chan_02.h423
│           ├── chan_03.h423
│           └── global.h423
├── specData
├── statData
├── maskData
├── transFuncData
├── images
└── mtProj.prj
</pre></div>
</div>
<p>The headers for the magnetotellruic and telluric data have been generated and the project can be loaded and the project timeline plotted.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># load the project</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">intersitePath</span><span class="p">,</span> <span class="s2">&quot;customconfig.ini&quot;</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;timeline.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/timeline.png" />
<p class="caption"><span class="caption-text">Project timeline</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The configuration that will be used is the same that was used in the <a class="reference internal" href="../cookbook/processing-lemi-b423.html"><span class="doc">Processing Lemi B423 data</span></a> example, which has more information about why that configuration was chosen. The configuration parameters are shown below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = customwin

[Spectra]
specdir = &quot;customwin&quot;

[Window]
windowsizes = 1024, 512, 256, 256, 128, 128, 128
overlapsizes = 256, 128, 64, 64, 32, 32, 32

[Statistics]
stats = &quot;coherence&quot;, &quot;transferFunction&quot;,
</pre></div>
</td></tr></table></div>
<p>Time data can be viewed in the usual way with the <a class="reference internal" href="../api/resistics.project.time.html#resistics.project.time.viewTime" title="resistics.project.time.viewTime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">viewTime()</span></code></a> method.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># view time</span>
<span class="kn">from</span> <span class="nn">resistics.project.time</span> <span class="kn">import</span> <span class="n">viewTime</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">startDate</span><span class="o">=</span><span class="s2">&quot;2019-05-27 14:15:00&quot;</span><span class="p">,</span>
    <span class="n">endDate</span><span class="o">=</span><span class="s2">&quot;2019-05-27 15:00:00&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lpfilt&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;viewTime.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/viewTime.png" />
<p class="caption"><span class="caption-text">Viewing time series data. It appears as though the E<sub>y</sub> for the telluric data needs to be reversed.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>From looking at the time series plot, the E<sub>y</sub> channel of the telluric station needs a polarity reversal (multiply by -1). This can be done when calculating out spectra as shown below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate spectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>
<span class="n">calculateSpectra</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span> <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span> <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Now, statistics can be calculated for the magnetotelluric site.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are no useful statistics at this moment for telluric sites nor are there intersite statistics.</p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>53
54
55
56</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate statistics for MT site</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>

<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>With the statistics calculated, the intersite processing can be performed, initially without any statistic based masking.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># intersite</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">processProject</span><span class="p">,</span>
    <span class="n">processSite</span><span class="p">,</span>
    <span class="n">viewImpedance</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotOptions</span><span class="p">[</span><span class="s2">&quot;res_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">processSite</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">inputsite</span><span class="o">=</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;intersiteTransferFunction.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The important call in this section of code is the call to <a class="reference internal" href="../api/resistics.project.transfunc.html#resistics.project.transfunc.processSite" title="resistics.project.transfunc.processSite"><code class="xref py py-meth docutils literal notranslate"><span class="pre">processSite()</span></code></a>. In this call, we have set the output site as “site2_te” or the telluric site. The optional input of inputsite has been set to the magnetotellruic site, site1_mt. The result of this is:</p>
<ul class="simple">
<li>electric channel data will be taken from site2_te or the telluric site</li>
<li>magnetic channel data will be take from site1_mt or the magnetotelluric site</li>
</ul>
<p>The resultant intersite transfer function is shown below.</p>
<div class="align-center figure" id="id3">
<img alt="alternate text" src="../_images/intersiteTransferFunction.png" />
<p class="caption"><span class="caption-text">Intersite transfer function.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>In the <a class="reference internal" href="../cookbook/processing-lemi-b423.html"><span class="doc">Processing Lemi B423 data</span></a> example, a significantly better result was achieved using a varying coherence mask. The same can be done here, but the mask will only be based on the quality of the data at the magnetotelluric site as no statistics were calculated for the telluric site.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># now try again with some statistics for the dead band</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">3</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">4</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">5</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">6</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>

<span class="c1"># process with mask</span>
<span class="n">processSite</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">inputsite</span><span class="o">=</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">:</span> <span class="s2">&quot;coh80_100&quot;</span><span class="p">},</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite_coh80_100&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite_coh80_100&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;intersiteTransferFunctionMask.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id4">
<img alt="alternate text" src="../_images/intersiteTransferFunctionMask.png" />
<p class="caption"><span class="caption-text">The intersite transfer function with variable masking</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>There is still problems with the output at long periods, most noticeably in the phase. This is likely to be a synchronisation issue between the two sites.</p>
<div class="section" id="complete-example-scripts">
<h2>Complete example scripts<a class="headerlink" href="#complete-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of clarity, the complete example scripts is provided below.</p>
<p>Creating the project.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">intersitePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">newProject</span>

<span class="n">refTime</span> <span class="o">=</span> <span class="s2">&quot;2019-05-27 00:00:00&quot;</span>
<span class="n">newProject</span><span class="p">(</span><span class="n">intersitePath</span><span class="p">,</span> <span class="n">refTime</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Processing intersite transfer function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">intersitePath</span><span class="p">,</span> <span class="n">intersiteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># headers for MT stations</span>
<span class="kn">from</span> <span class="nn">resistics.time.reader_lemib423</span> <span class="kn">import</span> <span class="n">folderB423Headers</span>

<span class="n">folderB423Headers</span><span class="p">(</span>
    <span class="n">intersitePath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">hxSensor</span><span class="o">=</span><span class="mi">712</span><span class="p">,</span>
    <span class="n">hySensor</span><span class="o">=</span><span class="mi">710</span><span class="p">,</span>
    <span class="n">hzSensor</span><span class="o">=</span><span class="mi">714</span><span class="p">,</span>
    <span class="n">hGain</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">dx</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">dy</span><span class="o">=</span><span class="mf">60.7</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># headers for telluric only stations</span>
<span class="kn">from</span> <span class="nn">resistics.time.reader_lemib423e</span> <span class="kn">import</span> <span class="n">folderB423EHeaders</span>

<span class="n">folderB423EHeaders</span><span class="p">(</span>
    <span class="n">intersitePath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">ex</span><span class="o">=</span><span class="s2">&quot;E1&quot;</span><span class="p">,</span> <span class="n">ey</span><span class="o">=</span><span class="s2">&quot;E2&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">60.7</span>
<span class="p">)</span>

<span class="c1"># load the project</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">intersitePath</span><span class="p">,</span> <span class="s2">&quot;customconfig.ini&quot;</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;timeline.png&quot;</span><span class="p">)</span>

<span class="c1"># view time</span>
<span class="kn">from</span> <span class="nn">resistics.project.time</span> <span class="kn">import</span> <span class="n">viewTime</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">startDate</span><span class="o">=</span><span class="s2">&quot;2019-05-27 14:15:00&quot;</span><span class="p">,</span>
    <span class="n">endDate</span><span class="o">=</span><span class="s2">&quot;2019-05-27 15:00:00&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lpfilt&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;viewTime.png&quot;</span><span class="p">)</span>

<span class="c1"># calculate spectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>
<span class="n">calculateSpectra</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span> <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span> <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># calculate statistics for MT site</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>

<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>

<span class="c1"># intersite</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">processProject</span><span class="p">,</span>
    <span class="n">processSite</span><span class="p">,</span>
    <span class="n">viewImpedance</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotOptions</span><span class="p">[</span><span class="s2">&quot;res_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">processSite</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">inputsite</span><span class="o">=</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;intersiteTransferFunction.png&quot;</span><span class="p">)</span>

<span class="c1"># now try again with some statistics for the dead band</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">3</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">4</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">5</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">6</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">])</span>

<span class="c1"># process with mask</span>
<span class="n">processSite</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;site2_te&quot;</span><span class="p">,</span>
    <span class="mi">500</span><span class="p">,</span>
    <span class="n">inputsite</span><span class="o">=</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1_mt&quot;</span><span class="p">:</span> <span class="s2">&quot;coh80_100&quot;</span><span class="p">},</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite_coh80_100&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site2_te&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;intersite_coh80_100&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">intersiteImages</span> <span class="o">/</span> <span class="s2">&quot;intersiteTransferFunctionMask.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cookbook.html" class="btn btn-neutral float-right" title="Cookbook" accesskey="n" rel="next">Next</a>
      
      
        <a href="remote-reference-with-config.html" class="btn btn-neutral" title="Remote reference with configuration" accesskey="p" rel="prev">Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/unitedstack/sphinx_rtd_theme">theme</a> provided by <a href="https://github.com/unitedstack">UnitedStack</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.6rc1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>