

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Remote reference with configuration &mdash; resistics 0.0.6rc1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Intersite transfer functions" href="intersite-transfer-function.html" />
    <link rel="prev" title="Remote reference statistics" href="remote-reference-statistics.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../advanced.html">Advanced</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pre-process.html">Pre-processing timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference.html">Remote reference processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference-statistics.html">Remote reference statistics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Remote reference with configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="intersite-transfer-function.html">Intersite transfer functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case-studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog / backlog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">resistics</a> &raquo;</li>
        
          <li><a href="../advanced.html">Advanced</a> &raquo;</li>
        
      <li>Remote reference with configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/advanced/remote-reference-with-config.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="remote-reference-with-configuration">
<h1>Remote reference with configuration<a class="headerlink" href="#remote-reference-with-configuration" title="Permalink to this headline">¶</a></h1>
<p>Slowly, the remote reference result of Site M6 has been improving, but there are still some issues:</p>
<ul class="simple">
<li>The long period</li>
<li>The dead band</li>
</ul>
<p>The dead band is a challenging issue in magnetotellurics due to the poor signal-to-noise ratio. However, one thing that can be done to improve the long period is to change the minimum window size so there are more windows at high decimation levels (long periods).</p>
<div class="section" id="simple-configuration">
<h2>Simple configuration<a class="headerlink" href="#simple-configuration" title="Permalink to this headline">¶</a></h2>
<p>Configuration files provide an easy way to define processing parameters. They are described in more detail <a class="reference internal" href="../features/configuration.html"><span class="doc">here</span></a> and <a class="reference internal" href="../tutorial/configuration-files.html"><span class="doc">here</span></a>.</p>
<p>The below configuration file changes the decimation scheme to 8 decimation levels with 5 evaluation frequencies per level and the minimum window size. In addition, the remote statistics to calculate have been explicitly defined so they do not need to be specifed in the call to <a class="reference internal" href="../api/resistics.project.statistics.html#resistics.project.statistics.calculateRemoteStatistics" title="resistics.project.statistics.calculateRemoteStatistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateRemoteStatistics()</span></code></a>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = dec8_5

[Spectra]
specdir = &quot;dec8_5&quot;

[Decimation]
numlevels = 8

[Frequencies]
perlevel = 5

[Window]
minwindowsize = 256
minoverlapsize = 64

[Statistics]
remotestats = &quot;RR_coherenceEqn&quot;,
</pre></div>
</td></tr></table></div>
<p>As the decimation parameters have changed, the spectra need to be recalculated. The specdir option has also been changed, meaning that the spectra will be saved in a different directory and avoiding any future issues.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">It is important to understand the specdir (spectra directory) options in resistics to avoid future problems. For more information, please read <a class="reference internal" href="../tutorial/multiple-spectra.html"><span class="doc">Multiple Spectra</span></a>.</p>
</div>
<p>The following recalculates the spectra, the single site impedance tensors, the remote reference statistics, the mask and the remote reference impedance tensor.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">remotePath</span><span class="p">,</span> <span class="n">remoteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateRemoteStatistics</span><span class="p">,</span> <span class="n">viewStatistic</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">remotePath</span><span class="p">,</span> <span class="s2">&quot;remoteConfig.ini&quot;</span><span class="p">)</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># single site processing</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>    
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteM6_128_dec8_5.png&quot;</span><span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_dec8_5.png&quot;</span><span class="p">)</span>

<span class="c1"># calculate the statistic we are interested in</span>
<span class="n">calculateRemoteStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>

<span class="c1"># generate mask</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ExHyR-HyHyR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;EyHxR-HxHxR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]}</span>
<span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process with masks</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_dec8_5_coh_datetime_01.png&quot;</span><span class="p">)</span>

</pre></div>
</td></tr></table></div>
<p>The single site impedance tensor estimates are shown below.</p>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/singleSiteM6_128_dec8_5.png" />
<p class="caption"><span class="caption-text">Single site impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a minimum window size of 256 points.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/singleSiteRemote_128_dec8_5.png" />
<p class="caption"><span class="caption-text">Single site impedance tensor estimates for the Remote site at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a minimum window size of 256 points.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>The long periods have now improved, particularly for the Remote site. However, the dead band remains an issue for Remote and Site M6.</p>
<p>The remote reference processing result for Site M6 is shown below. The long periods are noticeably better in both phase and apparent resistivity than the results with the standard processing scheme. As stated earlier, the dead band shows no discernible improvement.</p>
<div class="align-center figure" id="id3">
<img alt="alternate text" src="../_images/remoteReferenceM6_128_RR_dec8_5_coh_datetime_01.png" />
<p class="caption"><span class="caption-text">Remote reference impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a minimum window size of 256 points. Masks and time constraints are applied.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id4">
<img alt="alternate text" src="../_images/remoteReferenceM6_128_RR_coh_datetime_01.png" />
<p class="caption"><span class="caption-text">Remote reference impedance tensor estimates for Site M6 at 128 Hz using the standard decimation and evaluation scheme. The same masks and time constraints are applied.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="customised-windowing">
<h2>Customised windowing<a class="headerlink" href="#customised-windowing" title="Permalink to this headline">¶</a></h2>
<p>Resistics gives fine grained control over windowing and overlaps. In the below configuration file, the same decimation scheme is used, with 8 decimation levels and 5 evaluation frequencies per level. However, the windowing has been defined explicitly for each decimation level. In addition and similar to the dec8_5 configuration file, the statistics and remote statistics to calculate have been explicitly defined so they do not need to be specifed in calls to <a class="reference internal" href="../api/resistics.project.statistics.html#resistics.project.statistics.calculateStatistics" title="resistics.project.statistics.calculateStatistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateStatistics()</span></code></a> and <a class="reference internal" href="../api/resistics.project.statistics.html#resistics.project.statistics.calculateRemoteStatistics" title="resistics.project.statistics.calculateRemoteStatistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateRemoteStatistics()</span></code></a>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = man8_5

[Spectra]
specdir = &quot;man8_5&quot;

[Decimation]
numlevels = 8

[Frequencies]
perlevel = 5

[Window]
windowsizes = 1024, 512, 512, 256, 256, 256, 256, 256
overlapsizes = 256, 128, 128, 64, 64, 64, 64, 64

[Statistics]
stats = &quot;coherence&quot;,
remotestats = &quot;RR_coherenceEqn&quot;,
</pre></div>
</td></tr></table></div>
<p>Like with the dec8_5 configuration file, begin with single site processing.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">remotePath</span><span class="p">,</span> <span class="n">remoteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">calculateStatistics</span><span class="p">,</span>
    <span class="n">calculateRemoteStatistics</span><span class="p">,</span>
    <span class="n">viewStatistic</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">remotePath</span><span class="p">,</span> <span class="s2">&quot;manualWindowsConfig.ini&quot;</span><span class="p">)</span>

<span class="c1"># calculate spectra</span>
<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteM6_128_man8_5.png&quot;</span><span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_man8_5.png&quot;</span><span class="p">)</span>

<span class="c1"># calculate the statistic we are interested in</span>
<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>
<span class="n">calculateRemoteStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>

<span class="c1"># generate single site masks</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process remote on its own to compare to the first processing we did</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_80_100&quot;</span><span class="p">},</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh_80_100&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh_80_100&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_man8_5_coh80.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id5">
<img alt="alternate text" src="../_images/singleSiteM6_128_man8_5.png" />
<p class="caption"><span class="caption-text">Single site impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id6">
<img alt="alternate text" src="../_images/singleSiteRemote_128_man8_5.png" />
<p class="caption"><span class="caption-text">Single site impedance tensor estimates for the Remote site at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>In addition to single site processing, Remote is processed with a coherence mask giving the below impedance tensor estimate.</p>
<div class="align-center figure" id="id7">
<img alt="alternate text" src="../_images/singleSiteRemote_128_man8_5_coh80.png" />
<p class="caption"><span class="caption-text">Single site impedance tensor estimates for the Remote site at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level. A coherence mask of 0.8 has applied to discard noisy windows.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>Applying the coherence mask has significantly improved the single site impedance tensor estimates for Remote in the dead band. However, in some cases, it has left no windows at the long periods (this is clear from the missing markers for some evaluation frequencies).</p>
<p>Next, the same remote reference processing is repeated with matching parameters to the dec8_5 processing as shown below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># generate mask</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ExHyR-HyHyR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;EyHxR-HxHxR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]}</span>
<span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process with masks</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_coh_datetime_01.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The resultant remote reference impedance tensor estimate for Site M6 is shown below.</p>
<div class="align-center figure" id="id8">
<img alt="alternate text" src="../_images/remoteReferenceM6_128_RR_man8_5_coh_datetime_01.png" />
<p class="caption"><span class="caption-text">Remote reference impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level. Masks and time constraints are applied.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>In general, the results are comparable with the other decimation/windowing schemes and are better in some places such as the long periods, and similar in others.</p>
<p>As an additional test, another mask is applied, which is the single site mask for Remote excluding Remote windows with coherence E<sub>x</sub>-H<sub>y</sub> or E<sub>y</sub>-H<sub>x</sub> below 0.8.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># one more example with multiple masks</span>
<span class="c1"># let&#39;s use standard coherence as well for Remote only</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">],</span> <span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_2coh_datetime_01.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id9">
<img alt="alternate text" src="../_images/remoteReferenceM6_128_RR_man8_5_2coh_datetime_01.png" />
<p class="caption"><span class="caption-text">Remote reference impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level. Masks and time constraints are applied. An additional mask is applied for Remote excluding Remote windows with coherence E<sub>x</sub>-H<sub>y</sub> or E<sub>y</sub>-H<sub>x</sub> below 0.8.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>The result here is not so good, but it has reduced the biasing in the dead band where previously phases were reaching 0. With extra work and configuration testing, this may be promising.</p>
<p>For a last try, variable single site coherence thresholds could be used to limit the Remote data using the <a class="reference internal" href="../api/resistics.mask.data.html#resistics.mask.data.MaskData.addConstraintLevel" title="resistics.mask.data.MaskData.addConstraintLevel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addConstraintLevel()</span></code></a> method of <a class="reference internal" href="../api/resistics.mask.data.html#resistics.mask.data.MaskData" title="resistics.mask.data.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a>. An example and the result are provided below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># try one more where the Remote coherence mask is variable to avoid losing two many windows and long periods</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh_variable&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">],</span> <span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_variable&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_variable_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_variable_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_cohvar_datetime_01.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id10">
<img alt="alternate text" src="../_images/remoteReferenceM6_128_RR_man8_5_cohvar_datetime_01.png" />
<p class="caption"><span class="caption-text">Remote reference impedance tensor estimates for Site M6 at 128 Hz using 8 decimation levels and 5 evaluation frequencies per level with a custom window size per decimation level. Masks and time constraints are applied. An additional mask is applied for Remote excluding Remote windows with coherence E<sub>x</sub>-H<sub>y</sub> or E<sub>y</sub>-H<sub>x</sub> below thresholds which are specified individually for each decimation level.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The data for this example has come from a field survey of northern Switzerland in 2016. This data is explored in more detail in a <a class="reference internal" href="../case-studies/switzerland-2016.html"><span class="doc">case study</span></a>.</p>
</div>
</div>
<div class="section" id="complete-example-scripts">
<h2>Complete example scripts<a class="headerlink" href="#complete-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of clarity, the complete example scripts are provided below.</p>
<p>Configuration dec8_5:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">remotePath</span><span class="p">,</span> <span class="n">remoteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateRemoteStatistics</span><span class="p">,</span> <span class="n">viewStatistic</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">remotePath</span><span class="p">,</span> <span class="s2">&quot;remoteConfig.ini&quot;</span><span class="p">)</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># single site processing</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>    
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteM6_128_dec8_5.png&quot;</span><span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_dec8_5.png&quot;</span><span class="p">)</span>

<span class="c1"># calculate the statistic we are interested in</span>
<span class="n">calculateRemoteStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>

<span class="c1"># generate mask</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ExHyR-HyHyR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;EyHxR-HxHxR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]}</span>
<span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process with masks</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_dec8_5_coh_datetime_01.png&quot;</span><span class="p">)</span>

</pre></div>
</td></tr></table></div>
<p>Configuration man8_5:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">remotePath</span><span class="p">,</span> <span class="n">remoteImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">calculateStatistics</span><span class="p">,</span>
    <span class="n">calculateRemoteStatistics</span><span class="p">,</span>
    <span class="n">viewStatistic</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>
<span class="kn">from</span> <span class="nn">resistics.common.plot</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">remotePath</span><span class="p">,</span> <span class="s2">&quot;manualWindowsConfig.ini&quot;</span><span class="p">)</span>

<span class="c1"># calculate spectra</span>
<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteM6_128_man8_5.png&quot;</span><span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_man8_5.png&quot;</span><span class="p">)</span>

<span class="c1"># calculate the statistic we are interested in</span>
<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>
<span class="n">calculateRemoteStatistics</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span> <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">])</span>

<span class="c1"># generate single site masks</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process remote on its own to compare to the first processing we did</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_80_100&quot;</span><span class="p">},</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh_80_100&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Remote&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh_80_100&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;singleSiteRemote_128_man8_5_coh80.png&quot;</span><span class="p">)</span>

<span class="c1"># generate mask</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;RR_coherenceEqn&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ExHyR-HyHyR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;EyHxR-HxHxR&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]}</span>
<span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># process with masks</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_coh_datetime_01.png&quot;</span><span class="p">)</span>

<span class="c1"># one more example with multiple masks</span>
<span class="c1"># let&#39;s use standard coherence as well for Remote only</span>
<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">],</span> <span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_80_100&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_80_100_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_80_100_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_2coh_datetime_01.png&quot;</span><span class="p">)</span>

<span class="c1"># try one more where the Remote coherence mask is variable to avoid losing two many windows and long periods</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraintLevel</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]},</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1"># finally, lets give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh_variable&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">,</span> <span class="s2">&quot;Remote&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">processProject</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">remotesite</span><span class="o">=</span><span class="s2">&quot;Remote&quot;</span><span class="p">,</span>
    <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;M6&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;rr_cohEqn_80_100&quot;</span><span class="p">],</span> <span class="s2">&quot;Remote&quot;</span><span class="p">:</span> <span class="s2">&quot;coh_variable&quot;</span><span class="p">},</span>
    <span class="n">datetimes</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;20:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;07:00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;levels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_variable_night&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M6&quot;</span><span class="p">],</span>
    <span class="n">sampleFreqs</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;rr_cohEqn_80_100_and_coh_variable_night&quot;</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>    
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">remoteImages</span> <span class="o">/</span> <span class="s2">&quot;remoteReferenceM6_128_RR_man8_5_cohvar_datetime_01.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="intersite-transfer-function.html" class="btn btn-neutral float-right" title="Intersite transfer functions" accesskey="n" rel="next">Next</a>
      
      
        <a href="remote-reference-statistics.html" class="btn btn-neutral" title="Remote reference statistics" accesskey="p" rel="prev">Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/unitedstack/sphinx_rtd_theme">theme</a> provided by <a href="https://github.com/unitedstack">UnitedStack</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.6rc1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>