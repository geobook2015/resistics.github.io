

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pre-processing timeseries data &mdash; resistics 0.0.6.dev2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Remote reference processing" href="remote-reference.html" />
    <link rel="prev" title="Advanced" href="../advanced.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../advanced.html">Advanced</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pre-processing timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference.html">Remote reference processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference-statistics.html">Remote reference statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-reference-with-config.html">Remote reference with configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="intersite-transfer-function.html">Intersite transfer functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case-studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">resistics</a> &raquo;</li>
        
          <li><a href="../advanced.html">Advanced</a> &raquo;</li>
        
      <li>Pre-processing timeseries data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/advanced/pre-process.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pre-processing-timeseries-data">
<h1>Pre-processing timeseries data<a class="headerlink" href="#pre-processing-timeseries-data" title="Permalink to this headline">¶</a></h1>
<p>There are scenarios in which time series data must be pre-processed and saved before transfer function calculation. Pre-processing is predominantly performed in the project environment using the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method. There are several pre-processing options available in <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method, including:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#data-resampling"><span class="std std-ref">Data resampling</span></a></li>
<li><a class="reference internal" href="#polarity-reversal"><span class="std std-ref">Polarity reversal</span></a></li>
<li><a class="reference internal" href="#scaling"><span class="std std-ref">Scaling</span></a></li>
<li><a class="reference internal" href="#calibration"><span class="std std-ref">Calibration</span></a></li>
<li><a class="reference internal" href="#low-band-and-high-pass-filtering"><span class="std std-ref">Low, band and high pass filtering</span></a></li>
<li><a class="reference internal" href="#notch-filter"><span class="std std-ref">Notch filter</span></a></li>
<li><a class="reference internal" href="#data-normalisation"><span class="std std-ref">Data normalisation</span></a></li>
<li><a class="reference internal" href="#interpolation-to-second"><span class="std std-ref">Interpolation to second</span></a></li>
</ul>
</div></blockquote>
<p>Another preprocessing method of use, but not available within the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method is gap filling. This can help increase the number of windows at long periods.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#gap-filling"><span class="std std-ref">Gap filling</span></a></li>
</ul>
</div></blockquote>
<p>In addition, there are lower levels APIs for performing these actions for advanced users. Please see the <a class="reference internal" href="../api.html"><span class="doc">API doc</span></a> for more information or check the <a class="reference internal" href="../cookbook.html"><span class="doc">Cookbook</span></a>.</p>
<p>The preprocessing options are explained in more detail below. The data is the same 4096 Hz data from the tutorial and is saved in “site1”. A project has already been setup following the instructions in <a class="reference internal" href="../tutorial/project-environment.html"><span class="doc">Project environment</span></a>. In all the following, the project has already been loaded as shown below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">preprocessPath</span><span class="p">,</span> <span class="n">preprocessImages</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="n">proj</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">preprocessPath</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>For plotting the time data, different plot options are used to give larger fonts. Plot fonts have been defined as follows:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTime</span><span class="p">,</span> <span class="n">getPresentationFonts</span>
<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTime</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPresentationFonts</span><span class="p">())</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="data-resampling">
<h2>Data resampling<a class="headerlink" href="#data-resampling" title="Permalink to this headline">¶</a></h2>
<p>Resampling time series data might be required to ensure matching sampling rates between different datasets, for example a local site and a reference site. This can be achieved through the resampling option in <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method which can save the data either to the same site or to a new site altogether.</p>
<p>Below is an exampling of downsampling a 4096 Hz dataset to 1024 Hz. The output will be saved to a new site named “site1_resample”. If the site does not already exist, it will be created. The name of the measurement in the new site will be:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">prepend + meas_[start_time] + postpend
give an example</p>
</div>
<p>As the measurement is being written out to a new site, prepend is being set “” (an empty string). By default, postpend is an empty string.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># resample to 1024 Hz and save in new site</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">preProcess</span>

<span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="n">resamp</span><span class="o">=</span><span class="p">{</span><span class="mi">4096</span><span class="p">:</span> <span class="mi">1024</span><span class="p">},</span> <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_resample&quot;</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># let&#39;s view the time series</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_resample&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeResample.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>These produce the following plots:</p>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/viewTimeResample.png" />
<p class="caption"><span class="caption-text">Resampling data from 4096 Hz to 1024 Hz example using the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="polarity-reversal">
<h2>Polarity reversal<a class="headerlink" href="#polarity-reversal" title="Permalink to this headline">¶</a></h2>
<p>This simply multiples the requested channels by -1. This is particularly useful when electric channels have been connected in the opposite way. An example is shown below of the polarity reversal of an electric channel.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># polarity reverse the Ey channel</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">preProcess</span><span class="p">,</span> <span class="n">viewTime</span>

<span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
    <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_polreverse&quot;</span><span class="p">,</span>
    <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:01&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_polreverse&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimePolarityReversal.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The results of this can be seen in the following figure.</p>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/viewTimePolarityReversal.png" />
<p class="caption"><span class="caption-text">Polarity reversal for channel E<sub>y</sub> using the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="scaling">
<h2>Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h2>
<p>If more arbitrary scaling control is required than simply multiplying by -1, the scale option of <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> can be used.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Ex&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_scale&quot;</span><span class="p">,</span>
    <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:01&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_scale&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeScale.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This will scale the E<sub>x</sub> channel by -2 and the E<sub>y</sub> channel by 0.5.</p>
<div class="align-center figure" id="id3">
<img alt="alternate text" src="../_images/viewTimeScale.png" />
<p class="caption"><span class="caption-text">Scaling channel E<sub>x</sub> by -2 and E<sub>y</sub> by 0.5 using the scale option of the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="calibration">
<h2>Calibration<a class="headerlink" href="#calibration" title="Permalink to this headline">¶</a></h2>
<p>The data can be pre-calibrated in a situation where calibrated time series data is required for viewing, exporting or other purposes. For example, data can be calibrated in resistics and then further processing can be done using other tools as required. To perform calibration, the calibration files need to be present in the calData folder of the project. For more information on calibration files, please see the <a class="reference internal" href="../formats/calibration.html"><span class="doc">Calibration</span></a> information in the <a class="reference internal" href="../formats.html"><span class="doc">Data formats</span></a> section.</p>
<p>Below is an example of calibrating time series:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="n">calibrate</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_calibrate&quot;</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_calibrate&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeCalibrate.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This will calibrate the magnetic channels in the data, converting them from mV to nT.</p>
<div class="align-center figure" id="id4">
<img alt="alternate text" src="../_images/viewTimeCalibrate.png" />
<p class="caption"><span class="caption-text">Calibrating the magnetic channels of the data using the calibration option of the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="low-band-and-high-pass-filtering">
<h2>Low, band and high pass filtering<a class="headerlink" href="#low-band-and-high-pass-filtering" title="Permalink to this headline">¶</a></h2>
<p>Time series data can be low, band and high pass filtered as required. This normally useful for viewing but can be useful for exporting or other purposes. Filter options can be specified in Hz using the <em>filter</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method. The keyword expects a dictionary with various filter options such as:</p>
<ul class="simple">
<li>lpfilt : low pass filtering</li>
<li>hpfilt : high pass filtering</li>
<li>bpfilt : band pass filtering</li>
</ul>
<p>Examples of each are provided below.</p>
<p>Low pass filtering using the lpfilt option to filter 4096 Hz to 32 Hz (without impacting the sampling rate).</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># resample to 1024 Hz and save in new site</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">preProcess</span><span class="p">,</span> <span class="n">viewTime</span>

<span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lpfilt&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">},</span> <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_lowpass&quot;</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_lowpass&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeLowpass.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id5">
<img alt="alternate text" src="../_images/viewTimeLowpass.png" />
<p class="caption"><span class="caption-text">Low pass filtering the time series data and saving it out to another site using the <em>filter</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>Highpass filtering can be specified in a similar way.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hpfilt&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">},</span> <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_highpass&quot;</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_highpass&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeHighpass.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id6">
<img alt="alternate text" src="../_images/viewTimeHighpass.png" />
<p class="caption"><span class="caption-text">High pass filtering the time series data and saving it out to another site using the <em>filter</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>Band pass filtering can performed as follows:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bpfilt&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]},</span>
    <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_bandpass&quot;</span><span class="p">,</span>
    <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_bandpass&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeBandpass.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id7">
<img alt="alternate text" src="../_images/viewTimeBandpass.png" />
<p class="caption"><span class="caption-text">Band pass filtering the time series data and saving it out to another site using the <em>filter</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method. Unlike high pass or low pass filtering, two frequencies need to provided, one defining the low cut and the other, the high cut.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="notch-filter">
<h2>Notch filter<a class="headerlink" href="#notch-filter" title="Permalink to this headline">¶</a></h2>
<p>Notch filters are useful ways to remove unwanted signal in data. The most common frequency domain noise spikes which may need filtering are powerline noise or railway noise at 50 Hz and 16.6 Hz respectively. Notching frequencies are specified in Hz using the <em>notch</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method. This is expected to be a list of frequencies to notch in Hz.</p>
<p>An example is given below of removing 50 Hz from time series data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">preProcess</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="n">notch</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">],</span> <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_notch&quot;</span><span class="p">,</span> <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:03&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_notch&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeNotch.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id8">
<img alt="alternate text" src="../_images/viewTimeNotch.png" />
<p class="caption"><span class="caption-text">Notch filtering the time series data and saving it out to another site using the <em>notch</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="data-normalisation">
<h2>Data normalisation<a class="headerlink" href="#data-normalisation" title="Permalink to this headline">¶</a></h2>
<p>Data normalisation normalises the data by diving by the norm of the data as calculated by numpy norm. There are few practical uses for this, though it may be of interest for other analytics based on the time series data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># normalisation</span>
<span class="n">preProcess</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="n">normalise</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">outputsite</span><span class="o">=</span><span class="s2">&quot;site1_norm&quot;</span><span class="p">,</span>
    <span class="n">prepend</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">proj</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:01&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_norm&quot;</span><span class="p">],</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeNorm.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id9">
<img alt="alternate text" src="../_images/viewTimeNorm.png" />
<p class="caption"><span class="caption-text">Normalising the time series data and saving it out to another site using the <em>normalise</em> keyword to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="interpolation-to-second">
<h2>Interpolation to second<a class="headerlink" href="#interpolation-to-second" title="Permalink to this headline">¶</a></h2>
<p>Resistics assumes that data is sampled on the second. For more information on this, please see <a class="reference internal" href="../formats/timeseries.html"><span class="doc">time series formats</span></a> and <a class="reference internal" href="../formats/timeseries/interpolation-to-second.html"><span class="doc">interpolation to second</span></a>.</p>
</div>
<div class="section" id="gap-filling">
<h2>Gap filling<a class="headerlink" href="#gap-filling" title="Permalink to this headline">¶</a></h2>
<p>In some situations, it is beneficial to stitch together two separate time series to increase the number of windows at long periods. This can be done through gap filling. However, resistics gap filling is external to the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.preProcess" title="resistics.project.projectTime.preProcess"><code class="xref py py-meth docutils literal notranslate"><span class="pre">preProcess()</span></code></a> method and has to be specified using other APIs.</p>
<p>To see an example, begin by saving smaller pieces of data from site1. Here, two smaller subsets are being saved to the same site, “site1_gaps”. To understand more about data readers in resistics, please see <a class="reference internal" href="../formats/timeseries.html"><span class="doc">time series formats</span></a>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resistics.ioHandlers.dataReaderATS</span> <span class="kn">import</span> <span class="n">DataReaderATS</span>

<span class="n">site1</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">getSiteData</span><span class="p">(</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="n">readerATS</span> <span class="o">=</span> <span class="n">DataReaderATS</span><span class="p">(</span><span class="n">site1</span><span class="o">.</span><span class="n">getMeasurementTimePath</span><span class="p">(</span><span class="s2">&quot;meas_2012-02-10_11-05-00&quot;</span><span class="p">))</span>
<span class="c1"># headers of recording</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">readerATS</span><span class="o">.</span><span class="n">getHeaders</span><span class="p">()</span>
<span class="n">chanHeaders</span><span class="p">,</span> <span class="n">chanMap</span> <span class="o">=</span> <span class="n">readerATS</span><span class="o">.</span><span class="n">getChanHeaders</span><span class="p">()</span>
<span class="c1"># separate out two datasets</span>
<span class="n">timeOriginal1</span> <span class="o">=</span> <span class="n">readerATS</span><span class="o">.</span><span class="n">getPhysicalData</span><span class="p">(</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span> <span class="s2">&quot;2012-02-10 11:09:00&quot;</span><span class="p">,</span> <span class="n">remaverage</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>
<span class="n">timeOriginal2</span> <span class="o">=</span> <span class="n">readerATS</span><span class="o">.</span><span class="n">getPhysicalData</span><span class="p">(</span>
    <span class="s2">&quot;2012-02-10 11:10:00&quot;</span><span class="p">,</span> <span class="s2">&quot;2012-02-10 11:14:00&quot;</span><span class="p">,</span> <span class="n">remaverage</span><span class="o">=</span><span class="bp">False</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.ioHandlers.dataWriterInternal</span> <span class="kn">import</span> <span class="n">DataWriterInternal</span>

<span class="c1"># create a new site</span>
<span class="n">proj</span><span class="o">.</span><span class="n">createSite</span><span class="p">(</span><span class="s2">&quot;site1_gaps&quot;</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">DataWriterInternal</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">setOutPath</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">timePath</span><span class="p">,</span> <span class="s2">&quot;site1_gaps&quot;</span><span class="p">,</span> <span class="s2">&quot;meas_2012-02-10_11-05-00_section1&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">chanHeaders</span><span class="p">,</span> <span class="n">timeOriginal1</span><span class="p">,</span> <span class="n">physical</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">setOutPath</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">timePath</span><span class="p">,</span> <span class="s2">&quot;site1_gaps&quot;</span><span class="p">,</span> <span class="s2">&quot;meas_2012-02-10_11-05-00_section2&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">chanHeaders</span><span class="p">,</span> <span class="n">timeOriginal2</span><span class="p">,</span> <span class="n">physical</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>

<span class="c1"># now view time</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:14:00&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_gaps&quot;</span><span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lpfilt&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">},</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeGaps.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id10">
<img alt="alternate text" src="../_images/viewTimeGaps.png" />
<p class="caption"><span class="caption-text">Splitting up site1 data into two smaller measurements in a new site named “site1_gaps”. Note, for the electric channel, the data does not sit on top of each other because the mean is being removed from all the measurements independently for visualisation.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>It is important at this stage not to remove the mean when getting the time data. Removing the mean will remove separate means for the independent sub time series as can be seen in the above figure. Mean is removed automatically for visualisation when using the <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.viewTime" title="resistics.project.projectTime.viewTime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">resistics.project.projectTime.viewTime()</span></code></a> method. However, by specifying when getting the time data that <code class="code python docutils literal notranslate"><span class="name"><span class="pre">remaverage</span></span><span class="operator"><span class="pre">=</span></span><span class="name builtin pseudo"><span class="pre">False</span></span></code>, the underlying data will still have the original average when written out.</p>
<p>The next stage is to read the separate data in as <a class="reference internal" href="../api/resistics.dataObjects.timeData.html#resistics.dataObjects.timeData.TimeData" title="resistics.dataObjects.timeData.TimeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeData</span></code></a> objects by using the <a class="reference internal" href="../api/resistics.ioHandlers.dataReaderInternal.html#resistics.ioHandlers.dataReaderInternal.DataReaderInternal" title="resistics.ioHandlers.dataReaderInternal.DataReaderInternal"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataReaderInternal</span></code></a> class.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resistics.ioHandlers.dataReaderInternal</span> <span class="kn">import</span> <span class="n">DataReaderInternal</span>

<span class="n">siteGaps</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">getSiteData</span><span class="p">(</span><span class="s2">&quot;site1_gaps&quot;</span><span class="p">)</span>
<span class="n">readerSection1</span> <span class="o">=</span> <span class="n">DataReaderInternal</span><span class="p">(</span>
    <span class="n">siteGaps</span><span class="o">.</span><span class="n">getMeasurementTimePath</span><span class="p">(</span><span class="s2">&quot;meas_2012-02-10_11-05-00_section1&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">timeData1</span> <span class="o">=</span> <span class="n">readerSection1</span><span class="o">.</span><span class="n">getPhysicalSamples</span><span class="p">(</span><span class="n">remaverage</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">timeData1</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="n">readerSection2</span> <span class="o">=</span> <span class="n">DataReaderInternal</span><span class="p">(</span>
    <span class="n">siteGaps</span><span class="o">.</span><span class="n">getMeasurementTimePath</span><span class="p">(</span><span class="s2">&quot;meas_2012-02-10_11-05-00_section2&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">timeData2</span> <span class="o">=</span> <span class="n">readerSection2</span><span class="o">.</span><span class="n">getPhysicalSamples</span><span class="p">(</span><span class="n">remaverage</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">timeData2</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The two separate datasets can be stitched together using the <a class="reference internal" href="../api/resistics.utilities.utilsInterp.html#resistics.utilities.utilsInterp.fillGap" title="resistics.utilities.utilsInterp.fillGap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">resistics.utilities.utilsInterp.fillGap()</span></code></a> method of module <a class="reference internal" href="../api/resistics.utilities.utilsInterp.html#module-resistics.utilities.utilsInterp" title="resistics.utilities.utilsInterp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">resistics.utilities.utilsInterp</span></code></a>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>68
69
70
71
72
73
74</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resistics.utilities.utilsInterp</span> <span class="kn">import</span> <span class="n">fillGap</span>

<span class="n">timeDataFilled</span> <span class="o">=</span> <span class="n">fillGap</span><span class="p">(</span><span class="n">timeData1</span><span class="p">,</span> <span class="n">timeData2</span><span class="p">)</span>
<span class="n">timeDataFilled</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">samplesToView</span> <span class="o">=</span> <span class="mi">14</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">4096</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">timeDataFilled</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">sampleStop</span><span class="o">=</span><span class="n">samplesToView</span><span class="p">,</span> <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;timeDataFilled.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The filled time data can be viewed using the <a class="reference internal" href="../api/resistics.dataObjects.timeData.html#resistics.dataObjects.timeData.TimeData.view" title="resistics.dataObjects.timeData.TimeData.view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">view()</span></code></a> method of the <a class="reference internal" href="../api/resistics.dataObjects.timeData.html#resistics.dataObjects.timeData.TimeData" title="resistics.dataObjects.timeData.TimeData"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeData</span></code></a> class.</p>
<div class="align-center figure" id="id11">
<img alt="alternate text" src="../_images/timeDataFilled.png" />
<p class="caption"><span class="caption-text">The filled time data. The missing points have now been filled in linearly between the two datasets. Note, this data is not low pass filtered like in the previous plot.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>Now the data can be written out using the <a class="reference internal" href="../api/resistics.ioHandlers.dataWriterInternal.html#resistics.ioHandlers.dataWriterInternal.DataWriterInternal" title="resistics.ioHandlers.dataWriterInternal.DataWriterInternal"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataWriterInternal</span></code></a> class.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>80
81
82
83
84
85
86
87
88
89
90
91</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># create a new site to write out to</span>
<span class="n">proj</span><span class="o">.</span><span class="n">createSite</span><span class="p">(</span><span class="s2">&quot;site1_filled&quot;</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
<span class="c1"># use channel headers from one of the datasets, stop date will be automatically amended</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">DataWriterInternal</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">setOutPath</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">timePath</span><span class="p">,</span> <span class="s2">&quot;site1_filled&quot;</span><span class="p">,</span> <span class="s2">&quot;meas_2012-02-10_11-05-00_filled&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">readerSection1</span><span class="o">.</span><span class="n">getHeaders</span><span class="p">()</span>
<span class="n">chanHeaders</span><span class="p">,</span> <span class="n">chanMap</span> <span class="o">=</span> <span class="n">readerSection1</span><span class="o">.</span><span class="n">getChanHeaders</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeData</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="n">chanHeaders</span><span class="p">,</span> <span class="n">timeDataFilled</span><span class="p">,</span> <span class="n">physical</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">proj</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Finally, view the new site with filled time data compared to the original.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># now view time</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">proj</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2012-02-10 11:14:00&quot;</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;site1_filled&quot;</span><span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lpfilt&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">},</span>
    <span class="n">chans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">preprocessImages</span> <span class="o">/</span> <span class="s2">&quot;viewTimeGapsFilled.png&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id12">
<img alt="alternate text" src="../_images/viewTimeGapsFilled.png" />
<p class="caption"><span class="caption-text">The filled time data in the new site “site1_filled”. By not removing the average throughout all the steps, the sticthed together data faithfully represents the original.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>For a better understanding of the processing sequence, it is possible to look at the comments file (dataset history) of the sticthed data.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span>-----------------------------
TimeData1 comments
Unscaled data 2012-02-10 11:05:00 to 2012-02-10 11:09:00 read in from measurement E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1\meas_2012-02-10_11-05-00, samples 0 to 983040
Sampling frequency 4096.0
Scaling channel Ex with scalar -0.000112591 to give mV
Dividing channel Ex by electrode distance 0.08 km to give mV/km
Scaling channel Ey with scalar -0.000112512 to give mV
Dividing channel Ey by electrode distance 0.091 km to give mV/km
Scaling channel Hx with scalar -0.00360174 to give mV
Scaling channel Hy with scalar -0.00360038 to give mV
Scaling channel Hz with scalar -0.0036007 to give mV
Remove zeros: False, remove nans: False, remove average: False
Dataset written to E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1_gaps\meas_2012-02-10_11-05-00_section1 on 2019-09-28 15:23:24.053960
Unscaled data 2012-02-10 11:05:00 to 2012-02-10 11:09:00 read in from measurement E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1_gaps\meas_2012-02-10_11-05-00_section1, samples 0 to 983040
Sampling frequency 4096.0
Remove zeros: False, remove nans: False, remove average: False
-----------------------------
TimeData2 comments
Unscaled data 2012-02-10 11:10:00 to 2012-02-10 11:14:00 read in from measurement E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1\meas_2012-02-10_11-05-00, samples 1228800 to 2211840
Sampling frequency 4096.0
Scaling channel Ex with scalar -0.000112591 to give mV
Dividing channel Ex by electrode distance 0.08 km to give mV/km
Scaling channel Ey with scalar -0.000112512 to give mV
Dividing channel Ey by electrode distance 0.091 km to give mV/km
Scaling channel Hx with scalar -0.00360174 to give mV
Scaling channel Hy with scalar -0.00360038 to give mV
Scaling channel Hz with scalar -0.0036007 to give mV
Remove zeros: False, remove nans: False, remove average: False
Dataset written to E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1_gaps\meas_2012-02-10_11-05-00_section2 on 2019-09-28 15:23:24.120020
Unscaled data 2012-02-10 11:10:00 to 2012-02-10 11:14:00 read in from measurement E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1_gaps\meas_2012-02-10_11-05-00_section2, samples 0 to 983040
Sampling frequency 4096.0
Remove zeros: False, remove nans: False, remove average: False
-----------------------------
Gap filled from 2012-02-10 11:09:00.000244 to 2012-02-10 11:09:59.999756
Dataset written to E:\magnetotellurics\code\resisticsdata\advanced\preprocessProject\timeData\site1_filled\meas_2012-02-10_11-05-00_filled on 2019-09-28 15:24:16.204023
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="remote-reference.html" class="btn btn-neutral float-right" title="Remote reference processing" accesskey="n" rel="next">Next</a>
      
      
        <a href="../advanced.html" class="btn btn-neutral" title="Advanced" accesskey="p" rel="prev">Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/unitedstack/sphinx_rtd_theme">theme</a> provided by <a href="https://github.com/unitedstack">UnitedStack</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.6.dev2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>