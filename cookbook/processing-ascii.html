

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Processing ASCII data &mdash; resistics 0.0.6.dev2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Processing Lemi B423 data" href="processing-lemi-b423.html" />
    <link rel="prev" title="Cookbook" href="../cookbook.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../cookbook.html">Cookbook</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Processing ASCII data</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing-lemi-b423.html">Processing Lemi B423 data</a></li>
<li class="toctree-l2"><a class="reference internal" href="processing-phoenix.html">Processing Phoenix data</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistic-plotting.html">Statistic plotting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../case-studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">resistics</a> &raquo;</li>
        
          <li><a href="../cookbook.html">Cookbook</a> &raquo;</li>
        
      <li>Processing ASCII data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/cookbook/processing-ascii.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="processing-ascii-data">
<h1>Processing ASCII data<a class="headerlink" href="#processing-ascii-data" title="Permalink to this headline">¶</a></h1>
<p>There are instances in which magnetotelluric time series data is better dealt with in ASCII format. ASCII format has some storage and efficiency costs, but does offer a method of last resort when either a data format is not supported or ASCII data is all that is available. To read more about the ASCII data format, see <a class="reference internal" href="../formats/timeseries/ascii-timeseries.html"><span class="doc">here</span></a>.</p>
<p>The following is an example of processing long-period ASCII data from a magnotelluric observatory, recorded by a LEMI device and sampled at 0.5 Hz.</p>
<p>There are five data files, one for each channel:</p>
<ul class="simple">
<li>bxnT.ascii</li>
<li>bynT.ascii</li>
<li>bznT.ascii</li>
<li>exmuVm.ascii</li>
<li>eymuVm.ascii</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The data files can be downloaded from <a class="reference external" href="https://1drv.ms/f/s!ApKs8ZhVotKMgR6lVt3iI4cR6QUg">here</a> for those interested in following along.</p>
</div>
<p>The units of the data are the following:</p>
<ul class="simple">
<li>Magnetic fields are in nT, which is the unit required by resistics (after calibration).</li>
<li>Electric fields are in microvolts per metre, which is the equivalent of mV/km, again the unit required by resistics.</li>
</ul>
<p>To begin, a new project and site is created.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span> <span class="c1"># import the project path</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">newProject</span>

<span class="c1"># define reference time for project</span>
<span class="n">referenceTime</span> <span class="o">=</span> <span class="s2">&quot;2018-01-01 00:00:00&quot;</span>
<span class="c1"># create a new project and print infomation</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">newProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">referenceTime</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="c1"># create a new site</span>
<span class="n">projData</span><span class="o">.</span><span class="n">createSite</span><span class="p">(</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This is a single site, therefore, the reference time is of little significance. A dummy reference time has been set for the data.</p>
<p>Under the site directory, a time series measurement directory needs to be created. This is a simple job of making a new directory, in this case named “meas”. The data files should be copied into this directory as shown below.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>asciiProject
├── calData
├── timeData
│   └── site1
|       └── meas
|           |── bxnT.ascii
|           |── bynT.ascii
|           |── bznT.ascii
|           |── exmuVm.ascii
|           └── eymuVm.ascii
├── specData
├── statData
├── maskData
├── transFuncData
├── images
└── mtProj.prj
</pre></div>
</div>
<p>After the project, site and measurement directory have been created, the data has to be prepared to be read in by resistics. This is achieved by using the <a class="reference internal" href="../api/resistics.ioHandlers.dataWriter.html#resistics.ioHandlers.dataWriter.DataWriter.writeTemplateHeaderFiles" title="resistics.ioHandlers.dataWriter.DataWriter.writeTemplateHeaderFiles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">writeTemplateHeaderFiles()</span></code></a> method of the class <a class="reference internal" href="../api/resistics.ioHandlers.dataWriter.html#resistics.ioHandlers.dataWriter.DataWriter" title="resistics.ioHandlers.dataWriter.DataWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataWriter</span></code></a>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span>
<span class="kn">from</span> <span class="nn">resistics.ioHandlers.dataWriter</span> <span class="kn">import</span> <span class="n">DataWriter</span>

<span class="n">asciiPath</span> <span class="o">=</span> <span class="n">projectPath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site1&quot;</span> <span class="o">/</span> <span class="s2">&quot;meas&quot;</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">DataWriter</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">setOutPath</span><span class="p">(</span><span class="n">asciiPath</span><span class="p">)</span>
<span class="n">chan2FileMap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Ex&quot;</span><span class="p">:</span> <span class="s2">&quot;exmuVm.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="s2">&quot;eymuVm.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hx&quot;</span><span class="p">:</span> <span class="s2">&quot;bxnT.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="s2">&quot;bynT.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hz&quot;</span><span class="p">:</span> <span class="s2">&quot;bznT.ascii&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">startDate</span> <span class="o">=</span> <span class="s2">&quot;2018-01-01 12:00:00&quot;</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeTemplateHeaderFiles</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">chan2FileMap</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">430000</span><span class="p">,</span> <span class="n">startDate</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The <a class="reference internal" href="../api/resistics.ioHandlers.dataWriter.html#resistics.ioHandlers.dataWriter.DataWriter.writeTemplateHeaderFiles" title="resistics.ioHandlers.dataWriter.DataWriter.writeTemplateHeaderFiles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">writeTemplateHeaderFiles()</span></code></a> creates dummy header files for the ASCII data allowing resistics to read it in appropriately. The dummy files it creates are:</p>
<ul class="simple">
<li>chan_00.hdr</li>
<li>chan_01.hdr</li>
<li>chan_02.hdr</li>
<li>chan_03.hdr</li>
<li>chan_04.hdr</li>
<li>global.hdr</li>
</ul>
<p>The measurement directory should now look like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>asciiProject
├── calData
├── timeData
│   └── site1
|       └── meas
|           |── global.hdr
|           |── chan_00.hdr
|           |── chan_01.hdr
|           |── chan_02.hdr
|           |── chan_03.hdr
|           |── chan_04.hdr
|           |── bxnT.ascii
|           |── bynT.ascii
|           |── bznT.ascii
|           |── exmuVm.ascii
|           └── eymuVm.ascii
├── specData
├── statData
├── maskData
├── transFuncData
├── images
└── mtProj.prj
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For a more in depth look at what is being done here, refer to <a class="reference internal" href="../formats/timeseries/ascii-timeseries.html"><span class="doc">ASCII time series</span></a>, which uses the same files to demonstrate ASCII data support in resistics.</p>
</div>
<p>The time series is now ready to be read in. In the below code block, the project and site timelines are plotted, giving two images, and then the time series is visualised.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load the project</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">projData</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;projectTimeline&quot;</span><span class="p">)</span>

<span class="c1"># view site data</span>
<span class="n">siteData</span> <span class="o">=</span> <span class="n">projData</span><span class="o">.</span><span class="n">getSiteData</span><span class="p">(</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">siteData</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;siteTimeline&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTime</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTime</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-03 00:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-05 00:00:00&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewTime&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/projectTimeline.png" />
<p class="caption"><span class="caption-text">Project timeline, though the reference time is purely a dummy one.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/siteTimeline.png" />
<p class="caption"><span class="caption-text">Site timeline.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id3">
<img alt="alternate text" src="../_images/viewTime1.png" />
<p class="caption"><span class="caption-text">Visualising time series.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The next step is to calculate out the spectra and then produce a spectra stack plot, which will help in assessing the quality of the data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate spectrum using standard options</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">calibrate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">viewSpectraStack</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsSpec</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsSpec</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewSpectraStack</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meas&quot;</span><span class="p">,</span>
    <span class="n">coherences</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">]],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewSpectraStack&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The spectra stack is shown below:</p>
<div class="align-center figure" id="id4">
<img alt="alternate text" src="../_images/viewSpectraStack.png" />
<p class="caption"><span class="caption-text">The spectra stack.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>The easiest way to process the ascii data is using the default parameterisation, much like in <a class="reference internal" href="../tutorial/up-and-running.html"><span class="doc">Up and running</span></a>.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># process the spectra to estimate the transfer function</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">])</span>

<span class="c1"># plot impedance tensor and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_default&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This gives the below impedance tensor estimate.</p>
<div class="align-center figure" id="id5">
<a class="reference internal image-reference" href="../_images/impedance_default.png"><img alt="alternate text" src="../_images/impedance_default.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">The impedance tensor estimate.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>Looking at the phase estimates, the phase for the ExHy component is in the wrong quadrant. This is generally due to a different polarity convention, which can be fixed by performing a polarity reversal, which is shown below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A polarity reversal sounds impressive but is simply a multiplication by -1. This does not change impedance tensor magnitude (therefore the apparent resistivity) but will have an impact on the phase.</p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate the tipper</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">)</span>

<span class="c1"># plot the tipper</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewTipper</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTipper</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTipper</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewTipper</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">,</span> <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_default_withHz&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The tipper estimate is shown below.</p>
<div class="align-center figure" id="id6">
<img alt="alternate text" src="../_images/impedance_default_withHz.png" />
<p class="caption"><span class="caption-text">The tipper estimate.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="changing-the-default-parameters">
<h2>Changing the default parameters<a class="headerlink" href="#changing-the-default-parameters" title="Permalink to this headline">¶</a></h2>
<p>As described in the <a class="reference internal" href="../tutorial/configuration-files.html"><span class="doc">Using configuration files</span></a> section in the <a class="reference internal" href="../tutorial.html"><span class="doc">Tutorial</span></a>, configuration files can be used to change the default parameterisation. The default parameters are not necessarily ideal for long period MT stations sampled at low sampling frequencies (here, 0.5 Hz). Therefore, it could be sensible to change the parameters here.</p>
<p>A new configuration file has been made and is included below:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = dec8_5

[Spectra]
specdir = &quot;dec8_5&quot;

[Decimation]
numlevels = 8

[Frequencies]
perlevel = 5

[Window]
windowfactor = 2
minwindowsize = 128
minoverlapsize = 32
</pre></div>
</td></tr></table></div>
<p>To use the configuration file, the project needs to be loaded along with the configuration file.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1">#  load the project and also provide a config file</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;asciiconfig.ini&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As the new configuration file includes new windowing parameters, a new set of spectra will be calculated out. The <strong>specdir</strong> option in the configuration deals with this.</p>
</div>
<p>The first task it to view the time series data with a polarity reversal. This can be done by specifying the <code class="code python docutils literal notranslate"><span class="name"><span class="pre">polreverse</span></span></code> keyword for <a class="reference internal" href="../api/resistics.project.projectTime.html#resistics.project.projectTime.viewTime" title="resistics.project.projectTime.viewTime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">viewTime()</span></code></a> as demonstrated below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTime</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTime</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-03 00:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-05 00:00:00&quot;</span><span class="p">,</span>
    <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewTime_polreverse&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id7">
<img alt="alternate text" src="../_images/viewTime_polreverse.png" />
<p class="caption"><span class="caption-text">Visualising time series with H<sub>y</sub> multiplied by -1.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>Following a similar scheme as the default example, the spectra can be calculated and a spectra stack plotted. However, the polarity reversal needs to be specified when calculating the spectra, as is done in the below example.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate spectrum using the new configuration</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">calibrate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
<span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># plot spectra stack</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">viewSpectraStack</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsSpec</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsSpec</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewSpectraStack</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meas&quot;</span><span class="p">,</span>
    <span class="n">coherences</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">]],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewSpectraStack_config_polreverse&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id8">
<img alt="alternate text" src="../_images/viewSpectraStack_config_polreverse.png" />
<p class="caption"><span class="caption-text">The spectra stack for the new configuration using 8 decimation levels and 5 evalution frequencies per level.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>As this configuration has fewer samples in a window, the resolution in frequency domain will be worse in comparison to the default parameters, which is clear from the plot.</p>
<p>Finally, the spectra can be processed to estimate the impedance tensor and tipper. First, the impedance tensor.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate impedance tensor</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">])</span>

<span class="c1"># plot impedance tensor and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The impedance tensor estimate is shown below and now the phases are all in the correct quadrants.</p>
<div class="align-center figure" id="id9">
<a class="reference internal image-reference" href="../_images/impedance_config.png"><img alt="alternate text" src="../_images/impedance_config.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">The impedance tensor estimate using 8 decimation levels and 5 evaluation frequencies per level.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>And for the tipper:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># process for the tipper</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewTipper</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTipper</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTipper</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewTipper</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">,</span> <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config_withHz&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id10">
<img alt="alternate text" src="../_images/impedance_config_withHz.png" />
<p class="caption"><span class="caption-text">The tipper estimate using 8 decimation levels and 5 evaluation frequencies per level.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>The next question to ask is whether statistics could improve the result.</p>
</div>
<div class="section" id="using-statistics-and-masks">
<h2>Using statistics and masks<a class="headerlink" href="#using-statistics-and-masks" title="Permalink to this headline">¶</a></h2>
<p>Begin once more by loading the project and configuration to continue working with the set of spectra where H<sub>y</sub> has had a polarity reversal.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1">#  load the project and also provide a config file</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;asciiconfig.ini&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>For more information about statistics, see the <a class="reference internal" href="../tutorial/statistics.html"><span class="doc">Statistics</span></a> section of the tutorial. Two statistics are calculated out here: coherence and transfer function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate statistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>

<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Next create a mask to perform simple coherence based rejection of time windows and view the mask.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># create a mask based on coherence</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh30_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;maskcoh&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id11">
<img alt="alternate text" src="../_images/maskcoh.png" />
<p class="caption"><span class="caption-text">The number of masked windows for each evaluation frequency in decimation level 0.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>More interesting plots can be made of statistics with masks as demonstrated in the <a class="reference internal" href="../tutorial/masks.html"><span class="doc">Masks</span></a> section of the tutorial, but this is left as an exercise.</p>
<p>Finally, calculate the impedance tensor estimate with the mask applied to exclude some windows.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate impedance tensor</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span> <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1&quot;</span><span class="p">:</span> <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span><span class="p">},</span> <span class="n">postpend</span><span class="o">=</span><span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span>
<span class="p">)</span>

<span class="c1"># plot transfer function and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config_masked&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id12">
<a class="reference internal image-reference" href="../_images/impedance_config_masked.png"><img alt="alternate text" src="../_images/impedance_config_masked.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">The impedance tensor estimate with masks applied.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>If aspects of this example using ASCII data were not clear, please see the <a class="reference internal" href="../tutorial.html"><span class="doc">Tutorial</span></a> for more information about resistics, <a class="reference internal" href="../formats.html"><span class="doc">Data formats</span></a> for data supported by resistics and <a class="reference internal" href="../advanced.html"><span class="doc">Advanced</span></a> for an overview of the more advanced functionality of resistics.</p>
<p>Note, that this was not an effort to optimise the result, but rather an example and walkthrough of processing ASCII data in resistics.</p>
</div>
<div class="section" id="complete-example-scripts">
<h2>Complete example scripts<a class="headerlink" href="#complete-example-scripts" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of clarity, the complete example scripts are provided below.</p>
<p>Create the project and a site:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span> <span class="c1"># import the project path</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">newProject</span>

<span class="c1"># define reference time for project</span>
<span class="n">referenceTime</span> <span class="o">=</span> <span class="s2">&quot;2018-01-01 00:00:00&quot;</span>
<span class="c1"># create a new project and print infomation</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">newProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">referenceTime</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="c1"># create a new site</span>
<span class="n">projData</span><span class="o">.</span><span class="n">createSite</span><span class="p">(</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Preparing the ascii data to be read in:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span>
<span class="kn">from</span> <span class="nn">resistics.ioHandlers.dataWriter</span> <span class="kn">import</span> <span class="n">DataWriter</span>

<span class="n">asciiPath</span> <span class="o">=</span> <span class="n">projectPath</span> <span class="o">/</span> <span class="s2">&quot;timeData&quot;</span> <span class="o">/</span> <span class="s2">&quot;site1&quot;</span> <span class="o">/</span> <span class="s2">&quot;meas&quot;</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">DataWriter</span><span class="p">()</span>
<span class="n">writer</span><span class="o">.</span><span class="n">setOutPath</span><span class="p">(</span><span class="n">asciiPath</span><span class="p">)</span>
<span class="n">chan2FileMap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Ex&quot;</span><span class="p">:</span> <span class="s2">&quot;exmuVm.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ey&quot;</span><span class="p">:</span> <span class="s2">&quot;eymuVm.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hx&quot;</span><span class="p">:</span> <span class="s2">&quot;bxnT.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="s2">&quot;bynT.ascii&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Hz&quot;</span><span class="p">:</span> <span class="s2">&quot;bznT.ascii&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">startDate</span> <span class="o">=</span> <span class="s2">&quot;2018-01-01 12:00:00&quot;</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeTemplateHeaderFiles</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">chan2FileMap</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">430000</span><span class="p">,</span> <span class="n">startDate</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Transfer function calculation with default parameters:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load the project</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">projData</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;projectTimeline&quot;</span><span class="p">)</span>

<span class="c1"># view site data</span>
<span class="n">siteData</span> <span class="o">=</span> <span class="n">projData</span><span class="o">.</span><span class="n">getSiteData</span><span class="p">(</span><span class="s2">&quot;site1&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">siteData</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;siteTimeline&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTime</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTime</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-03 00:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-05 00:00:00&quot;</span><span class="p">,</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewTime&quot;</span><span class="p">)</span>

<span class="c1"># calculate spectrum using standard options</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">calibrate</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">viewSpectraStack</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsSpec</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsSpec</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewSpectraStack</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meas&quot;</span><span class="p">,</span>
    <span class="n">coherences</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">]],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewSpectraStack&quot;</span><span class="p">)</span>

<span class="c1"># process the spectra to estimate the transfer function</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">])</span>

<span class="c1"># plot impedance tensor and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_default&quot;</span><span class="p">)</span>

<span class="c1"># calculate the tipper</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">)</span>

<span class="c1"># plot the tipper</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewTipper</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTipper</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTipper</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewTipper</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">,</span> <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_default_withHz&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Run with a configuration file:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1">#  load the project and also provide a config file</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;asciiconfig.ini&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTime</span> <span class="kn">import</span> <span class="n">viewTime</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTime</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsTime</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewTime</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-03 00:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2018-01-05 00:00:00&quot;</span><span class="p">,</span>
    <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewTime_polreverse&quot;</span><span class="p">)</span>

<span class="c1"># calculate spectrum using the new configuration</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>

<span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">calibrate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">polreverse</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Hy&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
<span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># plot spectra stack</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectSpectra</span> <span class="kn">import</span> <span class="n">viewSpectraStack</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsSpec</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotOptions</span> <span class="o">=</span> <span class="n">plotOptionsSpec</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">viewSpectraStack</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meas&quot;</span><span class="p">,</span>
    <span class="n">coherences</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Hy&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hx&quot;</span><span class="p">]],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotOptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;viewSpectraStack_config_polreverse&quot;</span><span class="p">)</span>

<span class="c1"># calculate impedance tensor</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">])</span>

<span class="c1"># plot impedance tensor and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config&quot;</span><span class="p">)</span>

<span class="c1"># process for the tipper</span>
<span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Hz&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewTipper</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTipper</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTipper</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewTipper</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;withHz&quot;</span><span class="p">,</span> <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config_withHz&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Run with statistics:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">configuration</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1">#  load the project and also provide a config file</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;asciiconfig.ini&quot;</span><span class="p">)</span>
<span class="n">projData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>

<span class="c1"># calculate statistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>

<span class="n">calculateStatistics</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>

<span class="c1"># create a mask based on coherence</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh30_100&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;maskcoh&quot;</span><span class="p">)</span>

<span class="c1"># calculate impedance tensor</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">processProject</span>

<span class="n">processProject</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="n">outchans</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">],</span> <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1&quot;</span><span class="p">:</span> <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span><span class="p">},</span> <span class="n">postpend</span><span class="o">=</span><span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span>
<span class="p">)</span>

<span class="c1"># plot transfer function and save the plot</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectTransferFunction</span> <span class="kn">import</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.utilities.utilsPlotter</span> <span class="kn">import</span> <span class="n">plotOptionsTransferFunction</span><span class="p">,</span> <span class="n">getPaperFonts</span>

<span class="n">plotoptions</span> <span class="o">=</span> <span class="n">plotOptionsTransferFunction</span><span class="p">(</span><span class="n">plotfonts</span><span class="o">=</span><span class="n">getPaperFonts</span><span class="p">())</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">]</span>
<span class="n">plotoptions</span><span class="p">[</span><span class="s2">&quot;phase_ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">],</span>
    <span class="n">postpend</span><span class="o">=</span><span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span><span class="p">,</span>
    <span class="n">oneplot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">polarisations</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ExHy&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHx&quot;</span><span class="p">],</span>
    <span class="n">plotoptions</span><span class="o">=</span><span class="n">plotoptions</span><span class="p">,</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;impedance_config_masked&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="processing-lemi-b423.html" class="btn btn-neutral float-right" title="Processing Lemi B423 data" accesskey="n" rel="next">Next</a>
      
      
        <a href="../cookbook.html" class="btn btn-neutral" title="Cookbook" accesskey="p" rel="prev">Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/unitedstack/sphinx_rtd_theme">theme</a> provided by <a href="https://github.com/unitedstack">UnitedStack</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.6.dev2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>