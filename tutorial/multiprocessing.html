

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multiprocessing &mdash; resistics 0.0.6 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Next steps" href="next-steps.html" />
    <link rel="prev" title="Date and time constraints" href="date-time-constraints.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="project-environment.html">The project environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewing-data.html">Viewing timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="up-and-running.html">Up and running</a></li>
<li class="toctree-l2"><a class="reference internal" href="tipper.html">Calculating the tipper</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewing-spectra.html">Viewing spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple-spectra.html">Multiple spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html">Using configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="masks.html">Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="mask-processing.html">Processing with masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="recap-and-deeper-dive.html">Recap and deeper dive</a></li>
<li class="toctree-l2"><a class="reference internal" href="date-time-constraints.html">Date and time constraints</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="next-steps.html">Next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case-studies.html">Case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog / backlog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">resistics</a> &raquo;</li>
        
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>Multiprocessing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/multiprocessing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multiprocessing">
<h1>Multiprocessing<a class="headerlink" href="#multiprocessing" title="Permalink to this headline">¶</a></h1>
<p>Processing magnetotelluric field surveys can be demanding if there many sites and long recordings. To help speed up processing, resistics supports multiprocessor computation using the python multiprocessing module (<a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html">read more here</a>). Multiprocessing can be used in the following processing steps:</p>
<ul class="simple">
<li><p>Spectra calculation</p></li>
<li><p>Statistic calculation</p></li>
<li><p>Transfer function estimation (robust regression)</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For Windows users, multiprocessing requires scripts using resistics and multiprocessing to be protected using <code class="code python docutils literal notranslate"><span class="keyword"><span class="pre">if</span></span> <span class="name variable magic"><span class="pre">__name__</span></span> <span class="operator"><span class="pre">==</span></span> <span class="literal string single"><span class="pre">‘__main__’</span></span></code>. For a more detailed explanation of why, please see the <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing-programming">offical python documentation</a>. What this means is illustrated in the below <a class="reference internal" href="#example"><span class="std std-ref">example</span></a>.</p>
</div>
<p>Multiprocessing is activated by specifying the <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> keyword in the following methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/resistics.project.spectra.html#resistics.project.spectra.calculateSpectra" title="resistics.project.spectra.calculateSpectra"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateSpectra()</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/resistics.project.statistics.html#resistics.project.statistics.calculateStatistics" title="resistics.project.statistics.calculateStatistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateStatistics()</span></code></a></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">processProject()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">processSite()</span></code></p></li>
</ul>
<p>The optional argument <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> is expected to be an integer. It is recommend to use less cores than cores available on the system. This will leave spare processing power for system tasks and for interaction with the system.</p>
<p>Alternatively and probably more usefully, the <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> options can be set in configuration files, where it can be either a subparameter or a global parameter.</p>
<p>For example, setting <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> as a global parameter:</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = multi
ncores = 6

[Spectra]
specdir = &quot;multi&quot;

[Statistics]
stats = &quot;coherence&quot;, &quot;transferFunction&quot;,
remotestats = &quot;RR_coherenceEqn&quot;, &quot;RR_transferFunction&quot;
</pre></div>
</td></tr></table></div>
<p>By setting a global <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> option, any methods that support multiprocessing will use it on the globally specified number of cores.</p>
<p>Another option is to define <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> separately for individual tasks. The <code class="code python docutils literal notranslate"><span class="name"><span class="pre">ncores</span></span></code> option can be supplied to the following sections separately.</p>
<ul class="simple">
<li><p>Spectra</p></li>
<li><p>Statistics</p></li>
<li><p>Solver</p></li>
</ul>
<p>The following configuration specifies different cores for each section.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = multi

[Spectra]
ncores = 4
specdir = &quot;multi2&quot;

[Statistics]
ncores = 5
stats = &quot;coherence&quot;, &quot;transferFunction&quot;,
remotestats = &quot;RR_coherenceEqn&quot;, &quot;RR_transferFunction&quot;
</pre></div>
</td></tr></table></div>
<p>In the above config file, spectra calculations will use 4 cores, statistic calculations will use 5 cores and the solver (robust regression) will use only a single core.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The below configuration and processing script runs spectra, statistic and transfer function calculations on 6 cores.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>name = multi
ncores = 6

[Spectra]
specdir = &quot;multi&quot;

[Statistics]
stats = &quot;coherence&quot;, &quot;transferFunction&quot;,
remotestats = &quot;RR_coherenceEqn&quot;, &quot;RR_transferFunction&quot;
</pre></div>
</td></tr></table></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="s2">&quot;multiconfig.ini&quot;</span><span class="p">)</span>

    <span class="c1"># calculate spectrum using standard options</span>
    <span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    <span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
    <span class="n">calculateStatistics</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    
    <span class="c1"># process project with standard options</span>
    <span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    <span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;multproc_standard_process&quot;</span><span class="p">)</span>

    <span class="c1"># calculate mask for 128</span>
    <span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
    <span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
    <span class="c1"># calculate mask for 4096</span>
    <span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
    <span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
    <span class="c1"># process with masks</span>
    <span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1&quot;</span><span class="p">:</span> <span class="s2">&quot;coh70_100&quot;</span><span class="p">},</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">)</span>
    <span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
        <span class="n">projData</span><span class="p">,</span> <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span>
    <span class="p">)</span>
    <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;multproc_mask_process&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This script was run on the Windows platform. Note the use of <code class="code python docutils literal notranslate"><span class="keyword"><span class="pre">if</span></span> <span class="name variable magic"><span class="pre">__name__</span></span> <span class="operator"><span class="pre">==</span></span> <span class="literal string single"><span class="pre">‘__main__’</span></span></code> to ensure no multiprocessing issues are encountered. Forgetting this part would cause many processes to be spawned which will consume system resources.</p>
</div>
<p>The impedance tensor estimates are shown below with and without masking.</p>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/multproc_standard_process.png" />
<p class="caption"><span class="caption-text">Multiprocessing using all standard options</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/multproc_mask_process.png" />
<p class="caption"><span class="caption-text">Multiprocessing with masks</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="complete-example-script">
<h2>Complete example script<a class="headerlink" href="#complete-example-script" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of clarity, the complete example script is provided below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datapaths</span> <span class="kn">import</span> <span class="n">projectPath</span><span class="p">,</span> <span class="n">imagePath</span>
<span class="kn">from</span> <span class="nn">resistics.project.io</span> <span class="kn">import</span> <span class="n">loadProject</span>
<span class="kn">from</span> <span class="nn">resistics.project.spectra</span> <span class="kn">import</span> <span class="n">calculateSpectra</span>
<span class="kn">from</span> <span class="nn">resistics.project.transfunc</span> <span class="kn">import</span> <span class="n">processProject</span><span class="p">,</span> <span class="n">viewImpedance</span>
<span class="kn">from</span> <span class="nn">resistics.project.statistics</span> <span class="kn">import</span> <span class="n">calculateStatistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.mask</span> <span class="kn">import</span> <span class="n">newMaskData</span><span class="p">,</span> <span class="n">calculateMask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="s2">&quot;multiconfig.ini&quot;</span><span class="p">)</span>

    <span class="c1"># calculate spectrum using standard options</span>
    <span class="n">calculateSpectra</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    <span class="n">projData</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
    <span class="n">calculateStatistics</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    
    <span class="c1"># process project with standard options</span>
    <span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">)</span>
    <span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;multproc_standard_process&quot;</span><span class="p">)</span>

    <span class="c1"># calculate mask for 128</span>
    <span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
    <span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
    <span class="c1"># calculate mask for 4096</span>
    <span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
    <span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
    <span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
    <span class="c1"># process with masks</span>
    <span class="n">processProject</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;site1&quot;</span><span class="p">:</span> <span class="s2">&quot;coh70_100&quot;</span><span class="p">},</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">)</span>
    <span class="n">figs</span> <span class="o">=</span> <span class="n">viewImpedance</span><span class="p">(</span>
        <span class="n">projData</span><span class="p">,</span> <span class="n">oneplot</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">postpend</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="bp">False</span>
    <span class="p">)</span>
    <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imagePath</span> <span class="o">/</span> <span class="s2">&quot;multproc_mask_process&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="next-steps.html" class="btn btn-neutral float-right" title="Next steps" accesskey="n" rel="next">Next</a>
      
      
        <a href="date-time-constraints.html" class="btn btn-neutral" title="Date and time constraints" accesskey="p" rel="prev">Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/unitedstack/sphinx_rtd_theme">theme</a> provided by <a href="https://github.com/unitedstack">UnitedStack</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.6',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>