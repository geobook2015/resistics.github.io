

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Masks &mdash; resistics 0.0.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css\custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Processing with masks" href="mask-processing.html" />
    <link rel="prev" title="Statistics" href="statistics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> resistics
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../formats.html">Data formats</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="project-environment.html">The project environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewing-data.html">Viewing timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="up-and-running.html">Up and running</a></li>
<li class="toctree-l2"><a class="reference internal" href="tipper.html">Calculating the tipper</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewing-spectra.html">Viewing spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiple-spectra.html">Multiple spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration-files.html">Using configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html">Statistics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="mask-processing.html">Processing with masks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../donate.html">Donate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">resistics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>Masks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/masks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="masks">
<h1>Masks<a class="headerlink" href="#masks" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="statistics.html"><span class="doc">Statistics</span></a> give information about individual time windows. In resistics, masks are the way this information can be used.</p>
<p>A mask is used to exclude time windows from the transfer function calculation. Mask data is stored under the maskData folder. Masks are not individual to a specific time series measurement. Instead they are indexed by:</p>
<ol class="arabic simple">
<li>The site</li>
<li>The specdir</li>
<li>The sampling frequency</li>
</ol>
<p>For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>exampleProject
├── calData
├── timeData
│   └── site1
|       |── dataFolder1
│       |── dataFolder2
|       |──     .
|       |──     .
|       |──     .
|       └── dataFolderN
├── specData
│   └── site1
|       |── dataFolder1
|       |   |── dec8_5
|       |   └── spectra
|       |
│       |── dataFolder2
|       |   |── dec8_5
|       |   └── spectra
|       |──     .
|       |──     .
|       |──     .
|       └── dataFolderN
|           |── dec8_5
|           └── spectra
├── statData
│   └── site1
|       |── dataFolder1
|       |   |── dec8_5
|       |   |   |── coherence
|       |   |   |──     .
|       |   |   |──     .
|       |   |   |──     .
|       |   |   |── resPhase
|       |   |   └── transferFunction
|       |   └── spectra
|       |       |── coherence
|       |       |──     .
|       |       |──     .
|       |       |──     .
|       |       |── resPhase
|       |       └── transferFunction
|       |
│       |── dataFolder2
|       |   |── dec8_5
|       |   |   |── coherence
|       |   |   |──     .
|       |   |   |──     .
|       |   |   |──     .
|       |   |   |── resPhase
|       |   |   └── transferFunction
|       |   └── spectra
|       |       |── coherence
|       |       |──     .
|       |       |──     .
|       |       |──     .
|       |       |── resPhase
|       |       └── transferFunction
|       |──     .
|       |──     .
|       |──     .
|       └── dataFolderN
|           |── dec8_5
|           |   |── coherence
|           |   |──     .
|           |   |──     .
|           |   |──     .
|           |   |── resPhase
|           |   └── transferFunction
|           └── spectra
|               |── coherence
|               |──     .
|               |──     .
|               |──     .
|               |── resPhase
|               └── transferFunction
├── maskData
│   └── site1
|       └── dec8_5
|           |── {coh70_100_128_000.npy, coh70_100_128_000.info}
|           └── {coh70_100_4096_000.npy, coh70_100_4096_000.info}
├── transFuncData
├── images
└── mtProj.prj
</pre></div>
</div>
<p>Mask data is made up of two files:</p>
<ol class="arabic simple">
<li>The info file: coh70_100_128_000.info</li>
<li>The mask data file: coh70_100_128_000.npy</li>
</ol>
<p>The info file holds information about the statistics and constraints used to generate the mask file. The mask data is simply numpy array data holding information about which time windows to exclude.</p>
<p>The easiest way to understand masking is to step through an example. Begin, as usual, by loading the project.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load project and configuration file</span>
<span class="n">projectPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;tutorialProject&quot;</span><span class="p">)</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;tutorialConfig.ini&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>To generate new mask data, the method  <a class="reference internal" href="../api/resistics.project.projectMask.html#resistics.project.projectMask.newMaskData" title="resistics.project.projectMask.newMaskData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">newMaskData()</span></code></a> in module <a class="reference internal" href="../api/resistics.project.projectMask.html#module-resistics.project.projectMask" title="resistics.project.projectMask"><code class="xref py py-mod docutils literal notranslate"><span class="pre">projectMask</span></code></a> is used. To create a new mask, the sampling frequency to which the mask applies must be specified.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># get a mask data object and specify the sampling frequency to mask (128Hz)</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">newMaskData</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The method <a class="reference internal" href="../api/resistics.project.projectMask.html#resistics.project.projectMask.newMaskData" title="resistics.project.projectMask.newMaskData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">newMaskData()</span></code></a> returns a <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a> object, which will hold information about the statistics to use and the constraints.</p>
<p>The next step is to set the statistics to use for excluding windows. These statistics must already be calculated and were so in the <a class="reference internal" href="statistics.html"><span class="doc">Statistics</span></a> section.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># set the statistics to use in our masking - these must already be calculated out</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>After the statistics are chosen, the constraints can be defined.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># window must have the coherence parameters &quot;cohExHy&quot; and &quot;cohEyHx&quot; both between 0.7 and 1.0</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
</pre></div>
</td></tr></table></div>
<p>In the above example, a mask is being created that requires the E<sub>x</sub>-H<sub>y</sub> coherence <strong>and</strong> the E<sub>y</sub>-H<sub>x</sub> coherence to be between 0.70 and 1.00 for a time window. If this is not the case, then the time window will be masked (excluded) for the transfer funciton calculation.</p>
<p>Before writing out a mask dataset, the <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a> instance should be given a name.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The naming of mask files is made up of two parts:</p>
<ul class="simple">
<li>The mask name</li>
<li>The sampling frequency written to 3 decimal places and using a _ rather than . to indicate the decimal point (i.e. 128.000 becomes 128_000)</li>
</ul>
<p>Therefore, for the above example, the mask files will be:</p>
<ul class="simple">
<li>The info file: coh70_100_128_000.info</li>
<li>The mask data file: coh70_100_128_000.npy</li>
</ul>
<p>The <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a> parameters can be viewed by using the <a class="reference internal" href="../api/resistics.dataObjects.dataObject.html#resistics.dataObjects.dataObject.DataObject.printInfo" title="resistics.dataObjects.dataObject.DataObject.printInfo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">printInfo()</span></code></a> method of the <a class="reference internal" href="../api/resistics.dataObjects.dataObject.html#resistics.dataObjects.dataObject.DataObject" title="resistics.dataObjects.dataObject.DataObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataObject</span></code></a> parent class. The masking constraints can be printed to the terminal using the <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData.printConstraints" title="resistics.dataObjects.maskData.MaskData.printConstraints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">printConstraints()</span></code></a> method.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># print info to see what has been added</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printConstraints</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>So far, the following information has been defined:</p>
<ul class="simple">
<li>The sampling frequency</li>
<li>The statistics to use for masking</li>
<li>The constraints for the statistics</li>
</ul>
<p>However, the windows to mask have not yet been calculated. This is achieved by using the <a class="reference internal" href="../api/resistics.project.projectMask.html#resistics.project.projectMask.calculateMask" title="resistics.project.projectMask.calculateMask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculateMask()</span></code></a> method of the module <a class="reference internal" href="../api/resistics.project.projectMask.html#module-resistics.project.projectMask" title="resistics.project.projectMask"><code class="xref py py-mod docutils literal notranslate"><span class="pre">projectMask</span></code></a>. This method runs through the pre-calculated statistic data for all data of the given sampling frequency in a site and finds and saves the windows which do not meet the constraints.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate a file of masked windows for the sampling frequency associated with the maskData</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">calculateMask</span>

<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>As statistics are calculated on an evaluation frequency basis, masked windows are calculated for each evaluation frequency too.</p>
<p>Once the masked windows are calculated, they can then be viewed using the <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData.view" title="resistics.dataObjects.maskData.MaskData.view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">view()</span></code></a> method of <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a>. When using the <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData.view" title="resistics.dataObjects.maskData.MaskData.view"><code class="xref py py-meth docutils literal notranslate"><span class="pre">view()</span></code></a> method, the decimation level has to be specified. In the example above, this has been set to 0, which is the first decimation level. The resultant plot is shown below.</p>
<div class="align-center figure" id="id1">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Mask data plot for 128 Hz data using coherence constraints of 0.70-1.00</span></p>
</div>
<p>The bar chart at the bottom shows the number of masked windows for each evaluation frequency in the decimation level, plus the total number of masked windows for the decimation level. The top plot shows all the masked windows for the decimation level and which ones of those are masked for the individual evaluation frequencies. Poor quality time windows will generally be masked across all the evaluation frequencies.</p>
<p>The same process can be repeated for the 4096 Hz data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># do the same for 4096 Hz</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printConstraints</span><span class="p">()</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The mask data plot for the 4096 Hz data is shown below.</p>
<div class="align-center figure" id="id2">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Mask data plot for 4096 Hz data using coherence constraints of 0.70-1.00</span></p>
</div>
<p>Calculating masks with more than a single statistic can be done too. However, it is important to remember that <strong>only time windows which satisfy all the constraints</strong> will be used in the transfer function calculation. In the below example, a new mask is calculated using two statistics, coherence and transfer function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># calculate out statistics again, but this time use both transfer function and coherence</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;transferFunction&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;ExHyReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;ExHyImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This produces the plot:</p>
<div class="align-center figure" id="id3">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Mask data plot for 128 Hz data using coherence constraints of 0.70-1.00 and constraints on the transfer function values calculated on an individual window basis.</span></p>
</div>
<p>Notice that adding more constraints has increased the number of masked windows as expected. Repeating the exercise with the 4096 Hz data:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;transferFunction&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;ExHyReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;ExHyImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This produces the plot:</p>
<div class="align-center figure" id="id4">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Mask data plot for 4096 Hz data using coherence constraints of 0.70-1.00 and constraints on the transfer function values calculated on an individual window basis.</span></p>
</div>
<p>Here, the constraints have masked nearly all the windows for evaluation frequencies xx and xx. This is almost certainly over-zealous. Some statistic constraints can be provided on a global basis whereas others should be more targeted. More targeted constraints can be specified using the:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData.addConstraintLevel" title="resistics.dataObjects.maskData.MaskData.addConstraintLevel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addConstraintLevel()</span></code></a> method of <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a>, which allows setting constraints just for a specific decimation level.</li>
<li><a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData.addConstraintFreq" title="resistics.dataObjects.maskData.MaskData.addConstraintFreq"><code class="xref py py-meth docutils literal notranslate"><span class="pre">addConstraintFreq()</span></code></a> method of <a class="reference internal" href="../api/resistics.dataObjects.maskData.html#resistics.dataObjects.maskData.MaskData" title="resistics.dataObjects.maskData.MaskData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaskData</span></code></a>, which allows setting constraints for a specific evaluation frequency.</li>
</ol>
<p>Using the second option requires specification of decimation level and evaluation frequency. In resistics, these are generally specified using indices. To understand what that means, consider the evaluation frequencies in this set up using 8 decimation levels and 5 evaluation frequencies per level with a data sampling frequency of 128 Hz:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Decimation Level = 0: 32.00000000, 22.62741700, 16.00000000, 11.31370850, 8.00000000
Decimation Level = 1: 5.65685425, 4.00000000, 2.82842712, 2.00000000, 1.41421356
Decimation Level = 2: 1.00000000, 0.70710678, 0.50000000, 0.35355339, 0.25000000
Decimation Level = 3: 0.17677670, 0.12500000, 0.08838835, 0.06250000, 0.04419417
Decimation Level = 4: 0.03125000, 0.02209709, 0.01562500, 0.01104854, 0.00781250
Decimation Level = 5: 0.00552427, 0.00390625, 0.00276214, 0.00195312, 0.00138107
Decimation Level = 6: 0.00097656, 0.00069053, 0.00048828, 0.00034527, 0.00024414
Decimation Level = 7: 0.00017263, 0.00012207, 0.00008632, 0.00006104, 0.00004316
</pre></div>
</div>
<p>Decimation level numbering starts from 0 (and with 8 decimation levels, extends to 7). Evaluation frequency numbering begins from 0 (and with 5 evaluation frequencies per decimation level, extends to 4).</p>
<p>The decimation and evaluation frequency indices can be best demonstrated using a few of examples:</p>
<ul class="simple">
<li>Evaluation frequency 32 Hz, decimation level = 0, evaluation frequency index = 0</li>
<li>Evaluation frequency 1 Hz, decimation level = 2, evaluation frequency index = 0</li>
<li>Evaluation frequency 0.35355339 Hz, decimation level = 2, evaluation frequency index = 3</li>
</ul>
<p>The main motivation behind this is the difficulty in manually specifying evaluation frequencies such as 0.35355339 Hz.</p>
<div class="section" id="the-impact-of-masks-on-statistics">
<h2>The impact of masks on statistics<a class="headerlink" href="#the-impact-of-masks-on-statistics" title="Permalink to this headline">¶</a></h2>
<p>A more useful visualisation of masks is to see how removing selected time windows effects the statistics. In the <a class="reference internal" href="statistics.html"><span class="doc">Statistics</span></a> section, the plotting of statistics was demonstrated. Plotting statistics with masks applied is similar.</p>
<p>Load the project and use the <a class="reference internal" href="../api/resistics.project.projectMask.html#resistics.project.projectMask.getMaskData" title="resistics.project.projectMask.getMaskData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getMaskData()</span></code></a> method of the <a class="reference internal" href="../api/resistics.project.projectMask.html#module-resistics.project.projectMask" title="resistics.project.projectMask"><code class="xref py py-mod docutils literal notranslate"><span class="pre">projectMask</span></code></a> module to open up a previous calculated mask dataset.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load project and configuration file</span>
<span class="n">projectPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;tutorialProject&quot;</span><span class="p">)</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;tutorialConfig.ini&quot;</span><span class="p">)</span>

<span class="c1"># get mask data</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">getMaskData</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">getMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Next, get a set of masked windows for an evaluation frequency of 32 Hz, which translates to decimation level 0 and evaluation frequency index 0.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># get the masked windows for decimation level 0 and evaluation frequency index 0</span>
<span class="n">maskWindows</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">getMaskWindowsFreq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>To be able to plot the statistic data, this needs to be loaded to and can be by using the <a class="reference internal" href="../api/resistics.project.projectStatistics.html#resistics.project.projectStatistics.getStatisticData" title="resistics.project.projectStatistics.getStatisticData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getStatisticData()</span></code></a> method of module <a class="reference internal" href="../api/resistics.project.projectStatistics.html#module-resistics.project.projectStatistics" title="resistics.project.projectStatistics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">projectStatistics</span></code></a>. For more information, see the <a class="reference internal" href="statistics.html"><span class="doc">Statistics</span></a> section.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># get statistic data</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">getStatisticData</span>

<span class="n">statData</span> <span class="o">=</span> <span class="n">getStatisticData</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;meas_2012-02-10_11-30-00&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Now the statistic data can be plotted with the mask data. In the examples below, the statistic data is plotted both with and without masking to demonstrate the difference.</p>
<p>Viewing transfer function statistic data:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># view masked statistic data again but this with constraints on both coherence and transfer function</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id5">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic data without masking</span></p>
</div>
<div class="align-center figure" id="id6">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic data with masking (constraints on only coherence)</span></p>
</div>
<p>Histograms of transfer function statistic data:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># histogram</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id7">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic histogram without masking</span></p>
</div>
<div class="align-center figure" id="id8">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic histogram with masking (constraints on only coherence)</span></p>
</div>
<p>Crossplots of transfer function statistic data:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># crossplot</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id9">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic crossplot without masking</span></p>
</div>
<div class="align-center figure" id="id10">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic crossplot with masking (constraints on only coherence)</span></p>
</div>
<p>Repeating the same process with the second mask that was calculated (using both coherence and transfer function constraints) is easily done.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># view statistic data again but this time exclude the masked windows</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">getMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskWindows</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">getMaskWindowsFreq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="align-center figure" id="id11">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic with masking (constraints on both coherence and transfer function)</span></p>
</div>
<div class="align-center figure" id="id12">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic histogram with masking (constraints on both coherence and transfer function)</span></p>
</div>
<div class="align-center figure" id="id13">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic crossplot with masking (constraints on both coherence and transfer function)</span></p>
</div>
<p>Remember that statistic data is saved for each individual time series measurement directory. Hence, currently only the statistic values from one time series recordings are being considered. To really understand how masking windows will influence the transfer function calculation, the effect on the statistics for all time series measurements at a single sampling frequency in a site needs to be considered. This information can be plotted using the <a class="reference internal" href="../api/resistics.project.projectStatistics.html#resistics.project.projectStatistics.viewStatistic" title="resistics.project.projectStatistics.viewStatistic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">viewStatistic()</span></code></a> and  <a class="reference internal" href="../api/resistics.project.projectStatistics.html#resistics.project.projectStatistics.viewStatisticHistogram" title="resistics.project.projectStatistics.viewStatisticHistogram"><code class="xref py py-meth docutils literal notranslate"><span class="pre">viewStatisticHistogram()</span></code></a> of the <a class="reference internal" href="../api/resistics.project.projectStatistics.html#module-resistics.project.projectStatistics" title="resistics.project.projectStatistics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">projectStatistics</span></code></a> module. An example is provided below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># if there are more than one data folder of the same site for a sampling frequency</span>
<span class="c1"># the better way to plot statistics with masks is using the methods in projectStatistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">viewStatistic</span><span class="p">,</span> <span class="n">viewStatisticHistogram</span>

<span class="n">viewStatistic</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span>
    <span class="n">maskname</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">viewStatisticHistogram</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span>
    <span class="n">maskname</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">These plots can be quite intensive due to the number of time windows in the data. Therefore, it is usually best to save them rather than show them.</p>
</div>
<p>The result plots are shown below.</p>
<div class="align-center figure" id="id14">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic histogram with masking (constraints on both coherence and transfer function)</span></p>
</div>
<div class="align-center figure" id="id15">
<img alt="alternate text" src="../_images/stat_statData_coherence_view.png" />
<p class="caption"><span class="caption-text">Transfer function statistic crossplot with masking (constraints on both coherence and transfer function)</span></p>
</div>
</div>
<div class="section" id="complete-example-script">
<h2>Complete example script<a class="headerlink" href="#complete-example-script" title="Permalink to this headline">¶</a></h2>
<p>For the purposes of clarity, the complete example scripts are provided below.</p>
<p>For calculating masks from statistics:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load project and configuration file</span>
<span class="n">projectPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;tutorialProject&quot;</span><span class="p">)</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;tutorialConfig.ini&quot;</span><span class="p">)</span>

<span class="c1"># get a mask data object and specify the sampling frequency to mask (128Hz)</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">newMaskData</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="c1"># set the statistics to use in our masking - these must already be calculated out</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="c1"># window must have the coherence parameters &quot;cohExHy&quot; and &quot;cohEyHx&quot; both between 0.7 and 1.0</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="c1"># give maskData a name, which will relate to the output file</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
<span class="c1"># print info to see what has been added</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printConstraints</span><span class="p">()</span>

<span class="c1"># calculate a file of masked windows for the sampling frequency associated with the maskData</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">calculateMask</span>

<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># do the same for 4096 Hz</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100&quot;</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printInfo</span><span class="p">()</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">printConstraints</span><span class="p">()</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># calculate out statistics again, but this time use both transfer function and coherence</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;transferFunction&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;ExHyReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;ExHyImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">newMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">setStats</span><span class="p">([</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span><span class="s2">&quot;coherence&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;cohExHy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;cohEyHx&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]})</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">addConstraint</span><span class="p">(</span>
    <span class="s2">&quot;transferFunction&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;ExHyReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;ExHyImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxReal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s2">&quot;EyHxImag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">maskName</span> <span class="o">=</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span>
<span class="n">calculateMask</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="n">maskData</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;site1&quot;</span><span class="p">])</span>
<span class="n">maskData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

</pre></div>
</td></tr></table></div>
<p>To see the impact of masks on statistics:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectIO</span> <span class="kn">import</span> <span class="n">loadProject</span>

<span class="c1"># load project and configuration file</span>
<span class="n">projectPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;tutorialProject&quot;</span><span class="p">)</span>
<span class="n">projData</span> <span class="o">=</span> <span class="n">loadProject</span><span class="p">(</span><span class="n">projectPath</span><span class="p">,</span> <span class="n">configFile</span><span class="o">=</span><span class="s2">&quot;tutorialConfig.ini&quot;</span><span class="p">)</span>

<span class="c1"># get mask data</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectMask</span> <span class="kn">import</span> <span class="n">getMaskData</span>

<span class="n">maskData</span> <span class="o">=</span> <span class="n">getMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="c1"># get the masked windows for decimation level 0 and evaluation frequency index 0</span>
<span class="n">maskWindows</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">getMaskWindowsFreq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># get statistic data</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">getStatisticData</span>

<span class="n">statData</span> <span class="o">=</span> <span class="n">getStatisticData</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;meas_2012-02-10_11-30-00&quot;</span><span class="p">,</span> <span class="s2">&quot;transferFunction&quot;</span>
<span class="p">)</span>

<span class="c1"># view masked statistic data again but this with constraints on both coherence and transfer function</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="c1"># histogram</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="c1"># crossplot</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># view statistic data again but this time exclude the masked windows</span>
<span class="n">maskData</span> <span class="o">=</span> <span class="n">getMaskData</span><span class="p">(</span><span class="n">projData</span><span class="p">,</span> <span class="s2">&quot;site1&quot;</span><span class="p">,</span> <span class="s2">&quot;coh70_100_tfConstrained&quot;</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">maskWindows</span> <span class="o">=</span> <span class="n">maskData</span><span class="o">.</span><span class="n">getMaskWindowsFreq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">statData</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">])</span>
<span class="n">statData</span><span class="o">.</span><span class="n">crossplot</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">maskwindows</span><span class="o">=</span><span class="n">maskWindows</span><span class="p">,</span>
    <span class="n">crossplots</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;ExHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ExHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;ExHyImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHxReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHxImag&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;EyHyReal&quot;</span><span class="p">,</span> <span class="s2">&quot;EyHyImag&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># if there are more than one data folder of the same site for a sampling frequency</span>
<span class="c1"># the better way to plot statistics with masks is using the methods in projectStatistics</span>
<span class="kn">from</span> <span class="nn">resistics.project.projectStatistics</span> <span class="kn">import</span> <span class="n">viewStatistic</span><span class="p">,</span> <span class="n">viewStatisticHistogram</span>

<span class="n">viewStatistic</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span>
    <span class="n">maskname</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">viewStatisticHistogram</span><span class="p">(</span>
    <span class="n">projData</span><span class="p">,</span>
    <span class="s2">&quot;site1&quot;</span><span class="p">,</span>
    <span class="mi">128</span><span class="p">,</span>
    <span class="s2">&quot;coherence&quot;</span><span class="p">,</span>
    <span class="n">maskname</span><span class="o">=</span><span class="s2">&quot;coh70_100&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">save</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mask-processing.html" class="btn btn-neutral float-right" title="Processing with masks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="statistics.html" class="btn btn-neutral float-left" title="Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Neeraj Shah

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>